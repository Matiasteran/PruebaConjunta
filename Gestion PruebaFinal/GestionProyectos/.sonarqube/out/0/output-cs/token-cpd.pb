˜
cC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Env 
. 
Load 
( 	
)	 

;
 
var		 
dbServer		 
=		 
Environment		 
.		 "
GetEnvironmentVariable		 1
(		1 2
$str		2 =
)		= >
;		> ?
var

 

dbDatabase

 
=

 
Environment

 
.

 "
GetEnvironmentVariable

 3
(

3 4
$str

4 A
)

A B
;

B C
var 
dbUser 

= 
Environment 
. "
GetEnvironmentVariable /
(/ 0
$str0 9
)9 :
;: ;
var 

dbPassword 
= 
Environment 
. "
GetEnvironmentVariable 3
(3 4
$str4 A
)A B
;B C
var 
connectionString 
= 
$" 
$str  
{  !
dbServer! )
}) *
$str* +
"+ ,
+- .
$" 
$str "
{" #

dbDatabase# -
}- .
$str. /
"/ 0
+1 2
$" 
$str !
{! "
dbUser" (
}( )
$str) *
"* +
+, -
$" 
$str "
{" #

dbPassword# -
}- .
$str. /
"/ 0
+1 2
$" 
$str S
"S T
;T U
builder 
. 
Configuration 
[ 
$str ;
]; <
== >
connectionString? O
;O P
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options7 >
.> ?
UseSqlServer? K
(K L
builderL S
.S T
ConfigurationT a
.a b
GetConnectionStringb u
(u v
$str	v â
)
â ä
)
ä ã
)
ã å
;
å ç
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
app 
. 
Environment 
. 
IsDevelopment 
( 
) 
;  
app   
.   

UseSwagger   
(   
)   
;   
app!! 
.!! 
UseSwaggerUI!! 
(!! 
)!! 
;!! 
app$$ 
.$$ 
UseHttpsRedirection$$ 
($$ 
)$$ 
;$$ 
app%% 
.%% 
UseAuthorization%% 
(%% 
)%% 
;%% 
app&& 
.&& 
MapControllers&& 
(&& 
)&& 
;&& 
await'' 
app'' 	
.''	 

RunAsync''
 
('' 
)'' 
;'' ¯j
ÇC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Migrations\20250120230010_InitalCreate.cs
	namespace 	
prueba
 
. 

Migrations 
{ 
public 

partial 
class 
InitalCreate %
:& '
	Migration( 1
{ 
private 
const 
string 
SqlServerIdentity .
=/ 0
$str1 E
;E F
private 
const 
string 
NvarcharMax (
=) *
$str+ :
;: ;
private 
const 
string 
ReservasTableName .
=/ 0
$str1 ;
;; <
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
SqlServerIdentity$ 5
,5 6
$str7 =
)= >
,> ?
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
NvarcharMax8 C
,C D
nullableE M
:M N
falseO T
)T U
,U V
Apellido 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
NvarcharMax: E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Edad 
= 
table  
.  !
Column! '
<' (
int( +
>+ ,
(, -
type- 1
:1 2
$str3 8
,8 9
nullable: B
:B C
trueD H
)H I
,I J
Cedula 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
NvarcharMax8 C
,C D
nullableE M
:M N
falseO T
)T U
} 
, 
constraints 
: 
table "
=># %
{   
table!! 
.!! 

PrimaryKey!! $
(!!$ %
$str!!% 2
,!!2 3
x!!4 5
=>!!6 8
x!!9 :
.!!: ;
Id!!; =
)!!= >
;!!> ?
}"" 
)"" 
;"" 
migrationBuilder$$ 
.$$ 
CreateTable$$ (
($$( )
name%% 
:%% 
$str%% $
,%%$ %
columns&& 
:&& 
table&& 
=>&& !
new&&" %
{'' 
Id(( 
=(( 
table(( 
.(( 
Column(( %
<((% &
int((& )
>(() *
(((* +
type((+ /
:((/ 0
$str((1 6
,((6 7
nullable((8 @
:((@ A
false((B G
)((G H
.)) 

Annotation)) #
())# $
SqlServerIdentity))$ 5
,))5 6
$str))7 =
)))= >
,))> ?
	Capacidad** 
=** 
table**  %
.**% &
Column**& ,
<**, -
int**- 0
>**0 1
(**1 2
type**2 6
:**6 7
$str**8 =
,**= >
nullable**? G
:**G H
true**I M
)**M N
,**N O
NumeroDeHabitacion++ &
=++' (
table++) .
.++. /
Column++/ 5
<++5 6
int++6 9
>++9 :
(++: ;
type++; ?
:++? @
$str++A F
,++F G
nullable++H P
:++P Q
true++R V
)++V W
,++W X
Costo,, 
=,, 
table,, !
.,,! "
Column,," (
<,,( )
decimal,,) 0
>,,0 1
(,,1 2
type,,2 6
:,,6 7
$str,,8 G
,,,G H
nullable,,I Q
:,,Q R
false,,S X
),,X Y
,,,Y Z
Piso-- 
=-- 
table--  
.--  !
Column--! '
<--' (
int--( +
>--+ ,
(--, -
type--- 1
:--1 2
$str--3 8
,--8 9
nullable--: B
:--B C
true--D H
)--H I
}.. 
,.. 
constraints// 
:// 
table// "
=>//# %
{00 
table11 
.11 

PrimaryKey11 $
(11$ %
$str11% 6
,116 7
x118 9
=>11: <
x11= >
.11> ?
Id11? A
)11A B
;11B C
}22 
)22 
;22 
migrationBuilder44 
.44 
CreateTable44 (
(44( )
name55 
:55 
ReservasTableName55 '
,55' (
columns66 
:66 
table66 
=>66 !
new66" %
{77 
Id88 
=88 
table88 
.88 
Column88 %
<88% &
int88& )
>88) *
(88* +
type88+ /
:88/ 0
$str881 6
,886 7
nullable888 @
:88@ A
false88B G
)88G H
.99 

Annotation99 #
(99# $
SqlServerIdentity99$ 5
,995 6
$str997 =
)99= >
,99> ?
	ClienteId:: 
=:: 
table::  %
.::% &
Column::& ,
<::, -
int::- 0
>::0 1
(::1 2
type::2 6
:::6 7
$str::8 =
,::= >
nullable::? G
:::G H
false::I N
)::N O
,::O P
HabitacionId;;  
=;;! "
table;;# (
.;;( )
Column;;) /
<;;/ 0
int;;0 3
>;;3 4
(;;4 5
type;;5 9
:;;9 :
$str;;; @
,;;@ A
nullable;;B J
:;;J K
false;;L Q
);;Q R
,;;R S
FechaDeReserva<< "
=<<# $
table<<% *
.<<* +
Column<<+ 1
<<<1 2
DateTime<<2 :
><<: ;
(<<; <
type<<< @
:<<@ A
$str<<B M
,<<M N
nullable<<O W
:<<W X
false<<Y ^
)<<^ _
,<<_ `
FechaDeInicio== !
===" #
table==$ )
.==) *
Column==* 0
<==0 1
DateTime==1 9
>==9 :
(==: ;
type==; ?
:==? @
$str==A L
,==L M
nullable==N V
:==V W
false==X ]
)==] ^
,==^ _

FechaDeFin>> 
=>>  
table>>! &
.>>& '
Column>>' -
<>>- .
DateTime>>. 6
>>>6 7
(>>7 8
type>>8 <
:>>< =
$str>>> I
,>>I J
nullable>>K S
:>>S T
false>>U Z
)>>Z [
}?? 
,?? 
constraints@@ 
:@@ 
table@@ "
=>@@# %
{AA 
tableBB 
.BB 

PrimaryKeyBB $
(BB$ %
$strBB% 2
,BB2 3
xBB4 5
=>BB6 8
xBB9 :
.BB: ;
IdBB; =
)BB= >
;BB> ?
tableCC 
.CC 

ForeignKeyCC $
(CC$ %
nameDD 
:DD 
$strDD >
,DD> ?
columnEE 
:EE 
xEE  !
=>EE" $
xEE% &
.EE& '
	ClienteIdEE' 0
,EE0 1
principalTableFF &
:FF& '
$strFF( 2
,FF2 3
principalColumnGG '
:GG' (
$strGG) -
,GG- .
onDeleteHH  
:HH  !
ReferentialActionHH" 3
.HH3 4
CascadeHH4 ;
)HH; <
;HH< =
tableII 
.II 

ForeignKeyII $
(II$ %
nameJJ 
:JJ 
$strJJ E
,JJE F
columnKK 
:KK 
xKK  !
=>KK" $
xKK% &
.KK& '
HabitacionIdKK' 3
,KK3 4
principalTableLL &
:LL& '
$strLL( 6
,LL6 7
principalColumnMM '
:MM' (
$strMM) -
,MM- .
onDeleteNN  
:NN  !
ReferentialActionNN" 3
.NN3 4
CascadeNN4 ;
)NN; <
;NN< =
}OO 
)OO 
;OO 
migrationBuilderQQ 
.QQ 
CreateTableQQ (
(QQ( )
nameRR 
:RR 
$strRR ,
,RR, -
columnsSS 
:SS 
tableSS 
=>SS !
newSS" %
{TT 
IdUU 
=UU 
tableUU 
.UU 
ColumnUU %
<UU% &
intUU& )
>UU) *
(UU* +
typeUU+ /
:UU/ 0
$strUU1 6
,UU6 7
nullableUU8 @
:UU@ A
falseUUB G
)UUG H
.VV 

AnnotationVV #
(VV# $
SqlServerIdentityVV$ 5
,VV5 6
$strVV7 =
)VV= >
,VV> ?
DescripcionWW 
=WW  !
tableWW" '
.WW' (
ColumnWW( .
<WW. /
stringWW/ 5
>WW5 6
(WW6 7
typeWW7 ;
:WW; <
$strWW= L
,WWL M
nullableWWN V
:WWV W
falseWWX ]
)WW] ^
,WW^ _
CostoXX 
=XX 
tableXX !
.XX! "
ColumnXX" (
<XX( )
decimalXX) 0
>XX0 1
(XX1 2
typeXX2 6
:XX6 7
$strXX8 G
,XXG H
nullableXXI Q
:XXQ R
falseXXS X
)XXX Y
,XXY Z
	ReservaIdYY 
=YY 
tableYY  %
.YY% &
ColumnYY& ,
<YY, -
intYY- 0
>YY0 1
(YY1 2
typeYY2 6
:YY6 7
$strYY8 =
,YY= >
nullableYY? G
:YYG H
falseYYI N
)YYN O
}ZZ 
,ZZ 
constraints[[ 
:[[ 
table[[ "
=>[[# %
{\\ 
table]] 
.]] 

PrimaryKey]] $
(]]$ %
$str]]% >
,]]> ?
x]]@ A
=>]]B D
x]]E F
.]]F G
Id]]G I
)]]I J
;]]J K
table^^ 
.^^ 

ForeignKey^^ $
(^^$ %
name__ 
:__ 
$str__ J
,__J K
column`` 
:`` 
x``  !
=>``" $
x``% &
.``& '
	ReservaId``' 0
,``0 1
principalTableaa &
:aa& '
ReservasTableNameaa( 9
,aa9 :
principalColumnbb '
:bb' (
$strbb) -
,bb- .
onDeletecc  
:cc  !
ReferentialActioncc" 3
.cc3 4
Cascadecc4 ;
)cc; <
;cc< =
}dd 
)dd 
;dd 
migrationBuilderff 
.ff 
CreateIndexff (
(ff( )
namegg 
:gg 
$strgg -
,gg- .
tablehh 
:hh 
ReservasTableNamehh (
,hh( )
columnii 
:ii 
$strii #
)ii# $
;ii$ %
migrationBuilderkk 
.kk 
CreateIndexkk (
(kk( )
namell 
:ll 
$strll 0
,ll0 1
tablemm 
:mm 
ReservasTableNamemm (
,mm( )
columnnn 
:nn 
$strnn &
)nn& '
;nn' (
migrationBuilderpp 
.pp 
CreateIndexpp (
(pp( )
nameqq 
:qq 
$strqq 9
,qq9 :
tablerr 
:rr 
$strrr -
,rr- .
columnss 
:ss 
$strss #
)ss# $
;ss$ %
}tt 	
	protectedww 
overrideww 
voidww 
Downww  $
(ww$ %
MigrationBuilderww% 5
migrationBuilderww6 F
)wwF G
{xx 	
migrationBuilderyy 
.yy 
	DropTableyy &
(yy& '
namezz 
:zz 
$strzz ,
)zz, -
;zz- .
migrationBuilder|| 
.|| 
	DropTable|| &
(||& '
name}} 
:}} 
ReservasTableName}} '
)}}' (
;}}( )
migrationBuilder 
. 
	DropTable &
(& '
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ  
)
ÄÄ  !
;
ÄÄ! "
migrationBuilder
ÇÇ 
.
ÇÇ 
	DropTable
ÇÇ &
(
ÇÇ& '
name
ÉÉ 
:
ÉÉ 
$str
ÉÉ $
)
ÉÉ$ %
;
ÉÉ% &
}
ÑÑ 	
}
ÖÖ 
}ÜÜ ®X
ÉC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ServicioAdicionalController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 '
ServicioAdicionalController

 ,
:

- .
ControllerBase

/ =
{ 
private 
readonly 
AppDBContext %
_appDbContext& 3
;3 4
public '
ServicioAdicionalController *
(* +
AppDBContext+ 7
appDbContext8 D
)D E
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (#
GetServiciosAdicionales) @
(@ A
)A B
{ 	
var 
	servicios 
= 
await !
_appDbContext" /
./ 0 
ServiciosAdicionales0 D
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
)' (
. 
ThenInclude 
( 
r 
=> !
r" #
.# $
Cliente$ +
)+ ,
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
.' (

Habitacion( 2
)2 3
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
	servicios 
)  
;  !
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' ( 
GetServicioAdicional) =
(= >
int> A
idB D
)D E
{   	
var!! 
servicio!! 
=!! 
await!!  
_appDbContext!!! .
.!!. / 
ServiciosAdicionales!!/ C
."" 
Include"" 
("" 
s"" 
=>"" 
s"" 
.""  
Reserva""  '
)""' (
.## 
ThenInclude## 
(## 
r## 
=>## !
r##" #
.### $
Cliente##$ +
)##+ ,
.$$ 
Include$$ 
($$ 
s$$ 
=>$$ 
s$$ 
.$$  
Reserva$$  '
.$$' (

Habitacion$$( 2
)$$2 3
.%% 
FirstOrDefaultAsync%% $
(%%$ %
s%%% &
=>%%' )
s%%* +
.%%+ ,
Id%%, .
==%%/ 1
id%%2 4
)%%4 5
;%%5 6
if'' 
('' 
servicio'' 
=='' 
null''  
)''  !
return''" (
Ok'') +
(''+ ,
$str'', C
)''C D
;''D E
return)) 
Ok)) 
()) 
servicio)) 
))) 
;))  
}** 	
[,, 	
HttpPost,,	 
],, 
public-- 
async-- 
Task-- 
<-- 
IActionResult-- '
>--' (#
CreateServicioAdicional--) @
(--@ A
ServicioAdicional--A R
servicio--S [
)--[ \
{.. 	
if// 
(// 
string// 
.// 
IsNullOrWhiteSpace// )
(//) *
servicio//* 2
.//2 3
Descripcion//3 >
)//> ?
)//? @
{00 
return11 
Ok11 
(11 
$str11 F
)11F G
;11G H
}22 
var44 
descripcionRegex44  
=44! "
$str44# .
;44. /
if55 
(55 
!55 
Regex55 
.55 
IsMatch55 
(55 
servicio55 '
.55' (
Descripcion55( 3
,553 4
descripcionRegex555 E
)55E F
)55F G
{66 
return77 
Ok77 
(77 
$str77 C
)77C D
;77D E
}88 
if:: 
(:: 
!:: 
servicio:: 
.:: 
Descripcion:: %
.::% &
All::& )
(::) *
char::* .
.::. /
IsLetter::/ 7
)::7 8
)::8 9
{;; 
return<< 
Ok<< 
(<< 
$str<< D
)<<D E
;<<E F
}== 
if?? 
(?? 
servicio?? 
.?? 
Costo?? 
<=?? !
$num??" #
||??$ &
servicio??' /
.??/ 0
Costo??0 5
>??6 7
$num??8 ;
)??; <
{@@ 
returnAA 
OkAA 
(AA 
$strAA ;
)AA; <
;AA< =
}BB 
varDD 
reservaDD 
=DD 
awaitDD 
_appDbContextDD  -
.DD- .
ReservasDD. 6
.DD6 7
	FindAsyncDD7 @
(DD@ A
servicioDDA I
.DDI J
ReservaDDJ Q
.DDQ R
IdDDR T
)DDT U
;DDU V
ifEE 
(EE 
reservaEE 
==EE 
nullEE 
)EE  
{FF 
returnGG 
OkGG 
(GG 
$strGG 9
)GG9 :
;GG: ;
}HH 
servicioJJ 
.JJ 
ReservaJJ 
=JJ 
reservaJJ &
;JJ& '
_appDbContextLL 
.LL  
ServiciosAdicionalesLL .
.LL. /
AddLL/ 2
(LL2 3
servicioLL3 ;
)LL; <
;LL< =
awaitMM 
_appDbContextMM 
.MM  
SaveChangesAsyncMM  0
(MM0 1
)MM1 2
;MM2 3
returnOO 
OkOO 
(OO 
servicioOO 
)OO 
;OO  
}QQ 	
[SS 	
HttpPutSS	 
(SS 
$strSS 
)SS 
]SS 
publicTT 
asyncTT 
TaskTT 
<TT 
IActionResultTT '
>TT' (!
EditServicioAdicionalTT) >
(TT> ?
intTT? B
idTTC E
,TTE F
ServicioAdicionalTTG X
servicioTTY a
)TTa b
{UU 	
ifVV 
(VV 
idVV 
!=VV 
servicioVV 
.VV 
IdVV !
)VV! "
returnVV# )
OkVV* ,
(VV, -
$strVV- W
)VVW X
;VVX Y
varXX 
servicioExistenteXX !
=XX" #
awaitXX$ )
_appDbContextXX* 7
.XX7 8 
ServiciosAdicionalesXX8 L
.YY 
IncludeYY 
(YY 
sYY 
=>YY 
sYY 
.YY  
ReservaYY  '
)YY' (
.ZZ 
FirstOrDefaultAsyncZZ $
(ZZ$ %
sZZ% &
=>ZZ' )
sZZ* +
.ZZ+ ,
IdZZ, .
==ZZ/ 1
idZZ2 4
)ZZ4 5
;ZZ5 6
if\\ 
(\\ 
servicioExistente\\ !
==\\" $
null\\% )
)\\) *
return\\+ 1
Ok\\2 4
(\\4 5
$str\\5 V
)\\V W
;\\W X
if^^ 
(^^ 
string^^ 
.^^ 
IsNullOrWhiteSpace^^ )
(^^) *
servicio^^* 2
.^^2 3
Descripcion^^3 >
)^^> ?
)^^? @
{__ 
return`` 
Ok`` 
(`` 
$str`` F
)``F G
;``G H
}aa 
ifcc 
(cc 
serviciocc 
.cc 
Costocc 
<=cc !
$numcc" #
||cc$ &
serviciocc' /
.cc/ 0
Costocc0 5
>cc6 7
$numcc8 ;
)cc; <
{dd 
returnee 
Okee 
(ee 
$stree ;
)ee; <
;ee< =
}ff 
varhh 
reservahh 
=hh 
awaithh 
_appDbContexthh  -
.hh- .
Reservashh. 6
.hh6 7
	FindAsynchh7 @
(hh@ A
serviciohhA I
.hhI J
ReservahhJ Q
.hhQ R
IdhhR T
)hhT U
;hhU V
ifii 
(ii 
reservaii 
==ii 
nullii 
)ii  
{jj 
returnkk 
Okkk 
(kk 
$strkk :
)kk: ;
;kk; <
}ll 
servicioExistentenn 
.nn 
Descripcionnn )
=nn* +
servicionn, 4
.nn4 5
Descripcionnn5 @
;nn@ A
servicioExistenteoo 
.oo 
Costooo #
=oo$ %
serviciooo& .
.oo. /
Costooo/ 4
;oo4 5
servicioExistentepp 
.pp 
Reservapp %
=pp& '
reservapp( /
;pp/ 0
_appDbContextrr 
.rr  
ServiciosAdicionalesrr .
.rr. /
Updaterr/ 5
(rr5 6
servicioExistenterr6 G
)rrG H
;rrH I
awaitss 
_appDbContextss 
.ss  
SaveChangesAsyncss  0
(ss0 1
)ss1 2
;ss2 3
returnuu 
Okuu 
(uu 
servicioExistenteuu '
)uu' (
;uu( )
}vv 	
[xx 	

HttpDeletexx	 
(xx 
$strxx 
)xx 
]xx 
publicyy 
asyncyy 
Taskyy 
<yy 
IActionResultyy '
>yy' (#
DeleteServicioAdicionalyy) @
(yy@ A
intyyA D
idyyE G
)yyG H
{zz 	
var{{ 
servicio{{ 
={{ 
await{{  
_appDbContext{{! .
.{{. / 
ServiciosAdicionales{{/ C
.{{C D
	FindAsync{{D M
({{M N
id{{N P
){{P Q
;{{Q R
if|| 
(|| 
servicio|| 
==|| 
null||  
)||  !
return||" (
Ok||) +
(||+ ,
$str||, M
)||M N
;||N O
_appDbContext~~ 
.~~  
ServiciosAdicionales~~ .
.~~. /
Remove~~/ 5
(~~5 6
servicio~~6 >
)~~> ?
;~~? @
await 
_appDbContext 
.  
SaveChangesAsync  0
(0 1
)1 2
;2 3
return
ÅÅ 
Ok
ÅÅ 
(
ÅÅ 
new
ÅÅ 
{
ÅÅ 
message
ÅÅ #
=
ÅÅ$ %
$"
ÅÅ& (
$str
ÅÅ( B
{
ÅÅB C
id
ÅÅC E
}
ÅÅE F
$str
ÅÅF ^
"
ÅÅ^ _
}
ÅÅ` a
)
ÅÅa b
;
ÅÅb c
}
ÇÇ 	
}
ÉÉ 
}ÑÑ ⁄b
yC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ReservaController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
ReservaController "
:# $
ControllerBase% 3
{ 
private 
readonly 
AppDBContext %
_appDbContext& 3
;3 4
public 
ReservaController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetReservas) 4
(4 5
)5 6
{ 	
var 
reservas 
= 
await  
_appDbContext! .
.. /
Reservas/ 7
. 
Include 
( 
r 
=> 
r 
.  
Cliente  '
)' (
. 
Include 
( 
r 
=> 
r 
.  

Habitacion  *
)* +
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
reservas 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetReserva) 3
(3 4
int4 7
id8 :
): ;
{   	
var!! 
reserva!! 
=!! 
await!! 
_appDbContext!!  -
.!!- .
Reservas!!. 6
."" 
Include"" 
("" 
r"" 
=>"" 
r"" 
.""  
Cliente""  '
)""' (
.## 
Include## 
(## 
r## 
=>## 
r## 
.##  

Habitacion##  *
)##* +
.$$ 
FirstOrDefaultAsync$$ $
($$$ %
r$$% &
=>$$' )
r$$* +
.$$+ ,
Id$$, .
==$$/ 1
id$$2 4
)$$4 5
;$$5 6
if&& 
(&& 
reserva&& 
==&& 
null&& 
)&&  
return&&! '
Ok&&( *
(&&* +
$str&&+ A
)&&A B
;&&B C
return(( 
Ok(( 
((( 
reserva(( 
)(( 
;(( 
})) 	
[++ 	
HttpPost++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (
CreateReserva,,) 6
(,,6 7
Reserva,,7 >
reserva,,? F
),,F G
{-- 	
var.. 
validationResult..  
=..! "
await..# (
validar..) 0
(..0 1
reserva..1 8
)..8 9
;..9 :
if// 
(// 
validationResult//  
!=//! #
null//$ (
)//( )
{00 
return11 
validationResult11 '
;11' (
}22 
_appDbContext44 
.44 
Reservas44 "
.44" #
Add44# &
(44& '
reserva44' .
)44. /
;44/ 0
await55 
_appDbContext55 
.55  
SaveChangesAsync55  0
(550 1
)551 2
;552 3
return77 
Ok77 
(77 
reserva77 
)77 
;77 
}99 	
[;; 	
HttpPut;;	 
(;; 
$str;; 
);; 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
EditReserva<<) 4
(<<4 5
int<<5 8
id<<9 ;
,<<; <
Reserva<<= D
reserva<<E L
)<<L M
{== 	
if>> 
(>> 
id>> 
!=>> 
reserva>> 
.>> 
Id>>  
)>>  !
return>>" (
Ok>>) +
(>>+ ,
$str>>, M
)>>M N
;>>N O
var@@ 
reservaExistente@@  
=@@! "
await@@# (
_appDbContext@@) 6
.@@6 7
Reservas@@7 ?
.AA 
IncludeAA 
(AA 
rAA 
=>AA 
rAA 
.AA  
ClienteAA  '
)AA' (
.BB 
IncludeBB 
(BB 
rBB 
=>BB 
rBB 
.BB  

HabitacionBB  *
)BB* +
.CC 
FirstOrDefaultAsyncCC $
(CC$ %
rCC% &
=>CC' )
rCC* +
.CC+ ,
IdCC, .
==CC/ 1
idCC2 4
)CC4 5
;CC5 6
ifEE 
(EE 
reservaExistenteEE  
==EE! #
nullEE$ (
)EE( )
returnEE* 0
OkEE1 3
(EE3 4
$strEE4 J
)EEJ K
;EEK L
varGG 
validationResultGG  
=GG! "
awaitGG# (
validarGG) 0
(GG0 1
reservaGG1 8
,GG8 9
excludeReservaIdGG: J
:GGJ K
idGGL N
)GGN O
;GGO P
ifHH 
(HH 
validationResultHH  
!=HH! #
nullHH$ (
)HH( )
{II 
returnJJ 
validationResultJJ '
;JJ' (
}KK 
reservaExistenteMM 
.MM 
ClienteMM $
=MM% &
reservaMM' .
.MM. /
ClienteMM/ 6
;MM6 7
reservaExistenteNN 
.NN 

HabitacionNN '
=NN( )
reservaNN* 1
.NN1 2

HabitacionNN2 <
;NN< =
reservaExistenteOO 
.OO 
FechaDeReservaOO +
=OO, -
reservaOO. 5
.OO5 6
FechaDeReservaOO6 D
;OOD E
reservaExistentePP 
.PP 
FechaDeInicioPP *
=PP+ ,
reservaPP- 4
.PP4 5
FechaDeInicioPP5 B
;PPB C
reservaExistenteQQ 
.QQ 

FechaDeFinQQ '
=QQ( )
reservaQQ* 1
.QQ1 2

FechaDeFinQQ2 <
;QQ< =
_appDbContextSS 
.SS 
ReservasSS "
.SS" #
UpdateSS# )
(SS) *
reservaExistenteSS* :
)SS: ;
;SS; <
awaitTT 
_appDbContextTT 
.TT  
SaveChangesAsyncTT  0
(TT0 1
)TT1 2
;TT2 3
returnVV 
OkVV 
(VV 
reservaExistenteVV &
)VV& '
;VV' (
}WW 	
[YY 	

HttpDeleteYY	 
(YY 
$strYY 
)YY 
]YY 
publicZZ 
asyncZZ 
TaskZZ 
<ZZ 
IActionResultZZ '
>ZZ' (
DeleteReservaZZ) 6
(ZZ6 7
intZZ7 :
idZZ; =
)ZZ= >
{[[ 	
var\\ 
reserva\\ 
=\\ 
await\\ 
_appDbContext\\  -
.\\- .
Reservas\\. 6
.\\6 7
	FindAsync\\7 @
(\\@ A
id\\A C
)\\C D
;\\D E
if]] 
(]] 
reserva]] 
==]] 
null]] 
)]]  
return]]! '
Ok]]( *
(]]* +
$str]]+ A
)]]A B
;]]B C
_appDbContext__ 
.__ 
Reservas__ "
.__" #
Remove__# )
(__) *
reserva__* 1
)__1 2
;__2 3
await`` 
_appDbContext`` 
.``  
SaveChangesAsync``  0
(``0 1
)``1 2
;``2 3
returnbb 
Okbb 
(bb 
newbb 
{bb 
messagebb #
=bb$ %
$"bb& (
$strbb( 7
{bb7 8
idbb8 :
}bb: ;
$strbb; S
"bbS T
}bbU V
)bbV W
;bbW X
}cc 	
privateee 
asyncee 
Taskee 
<ee 
IActionResultee (
?ee( )
>ee) *
validaree+ 2
(ee2 3
Reservaee3 :
reservaee; B
,eeB C
inteeD G
?eeG H
excludeReservaIdeeI Y
=eeZ [
nullee\ `
)ee` a
{ff 	
vargg 
clientegg 
=gg 
awaitgg 
_appDbContextgg  -
.gg- .
Clientesgg. 6
.gg6 7
	FindAsyncgg7 @
(gg@ A
reservaggA H
.ggH I
ClienteggI P
.ggP Q
IdggQ S
)ggS T
;ggT U
varhh 

habitacionhh 
=hh 
awaithh "
_appDbContexthh# 0
.hh0 1
Habitacioneshh1 =
.hh= >
	FindAsynchh> G
(hhG H
reservahhH O
.hhO P

HabitacionhhP Z
.hhZ [
Idhh[ ]
)hh] ^
;hh^ _
ifjj 
(jj 

habitacionjj 
==jj 
nulljj "
)jj" #
{kk 
returnll 
Okll 
(ll 
$strll 0
)ll0 1
;ll1 2
}mm 
ifoo 
(oo 
clienteoo 
==oo 
nulloo 
)oo  
{pp 
returnqq 
Okqq 
(qq 
$strqq -
)qq- .
;qq. /
}rr 
iftt 
(tt 
reservatt 
.tt 
FechaDeIniciott %
<tt& '
reservatt( /
.tt/ 0
FechaDeReservatt0 >
)tt> ?
{uu 
returnvv 
Okvv 
(vv 
$strvv Z
)vvZ [
;vv[ \
}ww 
ifyy 
(yy 
reservayy 
.yy 

FechaDeFinyy "
<=yy# %
reservayy& -
.yy- .
FechaDeInicioyy. ;
)yy; <
{zz 
return{{ 
Ok{{ 
({{ 
$str{{ S
){{S T
;{{T U
}|| 
var~~ 
	conflicto~~ 
=~~ 
await~~ !
_appDbContext~~" /
.~~/ 0
Reservas~~0 8
.~~8 9
AnyAsync~~9 A
( 
r 
=> 
r 
. 

Habitacion "
." #
Id# %
==& (

habitacion) 3
.3 4
Id4 6
&&7 9
(
ÄÄ 
!
ÄÄ 
excludeReservaId
ÄÄ "
.
ÄÄ" #
HasValue
ÄÄ# +
||
ÄÄ, .
r
ÄÄ/ 0
.
ÄÄ0 1
Id
ÄÄ1 3
!=
ÄÄ4 6
excludeReservaId
ÄÄ7 G
)
ÄÄG H
&&
ÄÄI K
(
ÅÅ 
(
ÅÅ 
reserva
ÅÅ 
.
ÅÅ 
FechaDeInicio
ÅÅ '
>=
ÅÅ( *
r
ÅÅ+ ,
.
ÅÅ, -
FechaDeInicio
ÅÅ- :
&&
ÅÅ; =
reserva
ÅÅ> E
.
ÅÅE F
FechaDeInicio
ÅÅF S
<
ÅÅT U
r
ÅÅV W
.
ÅÅW X

FechaDeFin
ÅÅX b
)
ÅÅb c
||
ÅÅd f
(
ÇÇ 
reserva
ÇÇ 
.
ÇÇ 

FechaDeFin
ÇÇ #
>
ÇÇ$ %
r
ÇÇ& '
.
ÇÇ' (
FechaDeInicio
ÇÇ( 5
&&
ÇÇ6 8
reserva
ÇÇ9 @
.
ÇÇ@ A

FechaDeFin
ÇÇA K
<=
ÇÇL N
r
ÇÇO P
.
ÇÇP Q

FechaDeFin
ÇÇQ [
)
ÇÇ[ \
)
ÇÇ\ ]
)
ÇÇ] ^
;
ÇÇ^ _
if
ÑÑ 
(
ÑÑ 
	conflicto
ÑÑ 
)
ÑÑ 
{
ÖÖ 
return
ÜÜ 
Ok
ÜÜ 
(
ÜÜ 
$str
ÜÜ X
)
ÜÜX Y
;
ÜÜY Z
}
áá 
reserva
ââ 
.
ââ 
Cliente
ââ 
=
ââ 
cliente
ââ %
;
ââ% &
reserva
ää 
.
ää 

Habitacion
ää 
=
ää  

habitacion
ää! +
;
ää+ ,
return
åå 
null
åå 
;
åå 
}
çç 	
}
éé 
}èè ≥a
|C:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\HabitacionController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class  
HabitacionController %
:& '
ControllerBase( 6
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public  
HabitacionController #
(# $
AppDBContext$ 0
appDbContext1 =
)= >
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitaciones) 8
(8 9
)9 :
{ 	
var 
habitaciones 
= 
await $
_appDbContext% 2
.2 3
Habitaciones3 ?
.? @
ToListAsync@ K
(K L
)L M
;M N
return 
Ok 
( 
habitaciones "
)" #
;# $
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitacion) 6
(6 7
int7 :
id; =
)= >
{ 	
var 

habitacion 
= 
await "
_appDbContext# 0
.0 1
Habitaciones1 =
.= >
	FindAsync> G
(G H
idH J
)J K
;K L
if 
( 

habitacion 
== 
null "
)" #
return$ *
Ok+ -
(- .
$str. G
)G H
;H I
return 
Ok 
( 

habitacion  
)  !
;! "
} 	
[   	
HttpPost  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
CreateHabitacion!!) 9
(!!9 :

Habitacion!!: D

habitacion!!E O
)!!O P
{"" 	
if## 
(## 

habitacion## 
.## 
	Capacidad## $
==##% '
null##( ,
||##- /

habitacion##0 :
.##: ;
	Capacidad##; D
<=##E G
$num##H I
||##J L

habitacion##M W
.##W X
	Capacidad##X a
>=##b d
$num##e f
)##f g
{$$ 
return%% 
Ok%% 
(%% 
$str%% =
)%%= >
;%%> ?
}&& 
if(( 
((( 

habitacion(( 
.(( 
NumeroDeHabitacion(( -
==((. 0
null((1 5
||((6 8

habitacion((9 C
.((C D
NumeroDeHabitacion((D V
<=((W Y
$num((Z [
||((\ ^

habitacion((_ i
.((i j
NumeroDeHabitacion((j |
>((} ~
$num	((~ Å
)
((Å Ç
{)) 
return** 
Ok** 
(** 
$str** T
)**T U
;**U V
}++ 
var-- 
habitacionExistente-- #
=--$ %
await--& +
_appDbContext--, 9
.--9 :
Habitaciones--: F
.--F G
FirstOrDefaultAsync--G Z
(--Z [
h--[ \
=>--] _
h--` a
.--a b
NumeroDeHabitacion--b t
==--u w

habitacion	--x Ç
.
--Ç É 
NumeroDeHabitacion
--É ï
)
--ï ñ
;
--ñ ó
if.. 
(.. 
habitacionExistente.. #
!=..$ &
null..' +
)..+ ,
{// 
return00 
Ok00 
(00 
$str00 I
)00I J
;00J K
}11 
if33 
(33 

habitacion33 
.33 
Costo33  
<=33! #
$num33$ &
||33' )

habitacion33* 4
.334 5
Costo335 :
>33; <
$num33= @
)33@ A
{44 
return55 
Ok55 
(55 
$str55 <
)55< =
;55= >
}66 
if99 
(99 

habitacion99 
.99 
Piso99 
!=99  "
null99# '
&&99( *

habitacion99+ 5
.995 6
Piso996 :
<99; <
$num99= >
||99? A

habitacion99B L
.99L M
Piso99M Q
>99R S
$num99T V
)99V W
{:: 
return;; 
Ok;; 
(;; 
$str;; 9
);;9 :
;;;: ;
}<< 
_appDbContext>> 
.>> 
Habitaciones>> &
.>>& '
Add>>' *
(>>* +

habitacion>>+ 5
)>>5 6
;>>6 7
await?? 
_appDbContext?? 
.??  
SaveChangesAsync??  0
(??0 1
)??1 2
;??2 3
return@@ 
Ok@@ 
(@@ 

habitacion@@  
)@@  !
;@@! "
}BB 	
[DD 	
HttpPutDD	 
(DD 
$strDD 
)DD 
]DD 
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
EditHabitacionEE) 7
(EE7 8
intEE8 ;
idEE< >
,EE> ?

HabitacionEE@ J

habitacionEEK U
)EEU V
{FF 	
ifGG 
(GG 
idGG 
!=GG 

habitacionGG  
.GG  !
IdGG! #
)GG# $
returnGG% +
OkGG, .
(GG. /
$strGG/ S
)GGS T
;GGT U
varII 
habitacionExistenteII #
=II$ %
awaitII& +
_appDbContextII, 9
.II9 :
HabitacionesII: F
.IIF G
	FindAsyncIIG P
(IIP Q
idIIQ S
)IIS T
;IIT U
ifJJ 
(JJ 
habitacionExistenteJJ #
==JJ$ &
nullJJ' +
)JJ+ ,
returnJJ- 3
OkJJ4 6
(JJ6 7
$strJJ7 P
)JJP Q
;JJQ R
ifLL 
(LL 

habitacionLL 
.LL 
	CapacidadLL $
==LL% '
nullLL( ,
||LL- /

habitacionLL0 :
.LL: ;
	CapacidadLL; D
<=LLE G
$numLLH I
||LLJ L

habitacionLLM W
.LLW X
	CapacidadLLX a
>=LLb d
$numLLe f
)LLf g
{MM 
returnNN 
OkNN 
(NN 
$strNN =
)NN= >
;NN> ?
}OO 
ifQQ 
(QQ 

habitacionQQ 
.QQ 
NumeroDeHabitacionQQ -
==QQ. 0
nullQQ1 5
||QQ6 8

habitacionQQ9 C
.QQC D
NumeroDeHabitacionQQD V
<=QQW Y
$numQQZ [
||QQ\ ^

habitacionQQ_ i
.QQi j
NumeroDeHabitacionQQj |
>QQ} ~
$num	QQ Ç
)
QQÇ É
{RR 
returnSS 
OkSS 
(SS 
$strSS T
)SST U
;SSU V
}TT 
varVV 
otraHabitacionVV 
=VV  
awaitVV! &
_appDbContextVV' 4
.VV4 5
HabitacionesVV5 A
.VVA B
FirstOrDefaultAsyncVVB U
(VVU V
hVVV W
=>VVX Z
hVV[ \
.VV\ ]
NumeroDeHabitacionVV] o
==VVp r

habitacionVVs }
.VV} ~
NumeroDeHabitacion	VV~ ê
&&
VVë ì
h
VVî ï
.
VVï ñ
Id
VVñ ò
!=
VVô õ
id
VVú û
)
VVû ü
;
VVü †
ifWW 
(WW 
otraHabitacionWW 
!=WW !
nullWW" &
)WW& '
{XX 
returnYY 
OkYY 
(YY 
$strYY J
)YYJ K
;YYK L
}ZZ 
if\\ 
(\\ 

habitacion\\ 
.\\ 
Costo\\  
<=\\! #
$num\\$ &
||\\' )

habitacion\\* 4
.\\4 5
Costo\\5 :
>\\; <
$num\\= @
)\\@ A
{]] 
return^^ 
Ok^^ 
(^^ 
$str^^ <
)^^< =
;^^= >
}__ 
ifaa 
(aa 

habitacionaa 
.aa 
Pisoaa 
!=aa  "
nullaa# '
&&aa( *

habitacionaa+ 5
.aa5 6
Pisoaa6 :
<aa; <
$numaa= >
||aa? A

habitacionaaB L
.aaL M
PisoaaM Q
>aaR S
$numaaT V
)aaV W
{bb 
returncc 
Okcc 
(cc 
$strcc 9
)cc9 :
;cc: ;
}dd 
habitacionExistentehh 
.hh  
	Capacidadhh  )
=hh* +

habitacionhh, 6
.hh6 7
	Capacidadhh7 @
;hh@ A
habitacionExistenteii 
.ii  
NumeroDeHabitacionii  2
=ii3 4

habitacionii5 ?
.ii? @
NumeroDeHabitacionii@ R
;iiR S
habitacionExistentejj 
.jj  
Costojj  %
=jj& '

habitacionjj( 2
.jj2 3
Costojj3 8
;jj8 9
habitacionExistentekk 
.kk  
Pisokk  $
=kk% &

habitacionkk' 1
.kk1 2
Pisokk2 6
;kk6 7
_appDbContextnn 
.nn 
Habitacionesnn &
.nn& '
Updatenn' -
(nn- .
habitacionExistentenn. A
)nnA B
;nnB C
awaitoo 
_appDbContextoo 
.oo  
SaveChangesAsyncoo  0
(oo0 1
)oo1 2
;oo2 3
returnqq 
Okqq 
(qq 
habitacionExistenteqq )
)qq) *
;qq* +
}rr 	
[tt 	

HttpDeletett	 
(tt 
$strtt 
)tt 
]tt 
publicuu 
asyncuu 
Taskuu 
<uu 
IActionResultuu '
>uu' (
DeleteHabitacionuu) 9
(uu9 :
intuu: =
iduu> @
)uu@ A
{vv 	
varww 

habitacionww 
=ww 
awaitww "
_appDbContextww# 0
.ww0 1
Habitacionesww1 =
.ww= >
	FindAsyncww> G
(wwG H
idwwH J
)wwJ K
;wwK L
ifxx 
(xx 

habitacionxx 
==xx 
nullxx "
)xx" #
returnxx$ *
Okxx+ -
(xx- .
$strxx. G
)xxG H
;xxH I
varzz 
tieneReservacioneszz "
=zz# $
awaitzz% *
_appDbContextzz+ 8
.zz8 9
Reservaszz9 A
.zzA B
AnyAsynczzB J
(zzJ K
rzzK L
=>zzM O
rzzP Q
.zzQ R

HabitacionzzR \
.zz\ ]
Idzz] _
==zz` b
idzzc e
)zze f
;zzf g
if{{ 
({{ 
tieneReservaciones{{ "
){{" #
{|| 
return}} 
Ok}} 
(}} 
$str}} \
)}}\ ]
;}}] ^
}~~ 
_appDbContext
ÄÄ 
.
ÄÄ 
Habitaciones
ÄÄ &
.
ÄÄ& '
Remove
ÄÄ' -
(
ÄÄ- .

habitacion
ÄÄ. 8
)
ÄÄ8 9
;
ÄÄ9 :
await
ÅÅ 
_appDbContext
ÅÅ 
.
ÅÅ  
SaveChangesAsync
ÅÅ  0
(
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3
return
ÉÉ 
Ok
ÉÉ 
(
ÉÉ 
new
ÉÉ 
{
ÉÉ 
message
ÉÉ #
=
ÉÉ$ %
$"
ÉÉ& (
$str
ÉÉ( :
{
ÉÉ: ;
id
ÉÉ; =
}
ÉÉ= >
$str
ÉÉ> V
"
ÉÉV W
}
ÉÉX Y
)
ÉÉY Z
;
ÉÉZ [
}
ÑÑ 	
}
ÖÖ 
}ÜÜ ®ç
yC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ClienteController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ClienteController "
:# $
ControllerBase% 3
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public 
ClienteController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetClientes) 4
(4 5
)5 6
{ 	
var 
clientes 
= 
await  
_appDbContext! .
.. /
Clientes/ 7
.7 8
ToListAsync8 C
(C D
)D E
;E F
return 
Ok 
( 
clientes 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetCliente) 3
(3 4
int4 7
id8 :
): ;
{ 	
var 
cliente 
= 
await 
_appDbContext  -
.- .
Clientes. 6
.6 7
	FindAsync7 @
(@ A
idA C
)C D
;D E
if 
( 
cliente 
== 
null 
)  
return! '
Ok( *
(* +
$str+ A
)A B
;B C
return 
Ok 
( 
cliente 
) 
; 
} 	
[   	
HttpPost  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
CreateCliente!!) 6
(!!6 7
Cliente!!7 >
cliente!!? F
)!!F G
{"" 	
if$$ 
($$ 
string$$ 
.$$ 
IsNullOrWhiteSpace$$ )
($$) *
cliente$$* 1
.$$1 2
Nombre$$2 8
)$$8 9
)$$9 :
{%% 
return&& 
Ok&& 
(&& 
$str&& 4
)&&4 5
;&&5 6
}'' 
if(( 
((( 
!(( 
cliente(( 
.(( 
Nombre(( 
.((  
All((  #
(((# $
char(($ (
.((( )
IsLetter(() 1
)((1 2
)((2 3
{)) 
return** 
Ok** 
(** 
$str** ?
)**? @
;**@ A
}++ 
if.. 
(.. 
string.. 
... 
IsNullOrWhiteSpace.. )
(..) *
cliente..* 1
...1 2
Apellido..2 :
)..: ;
)..; <
{// 
return00 
Ok00 
(00 
$str00 6
)006 7
;007 8
}11 
if22 
(22 
!22 
cliente22 
.22 
Apellido22 !
.22! "
All22" %
(22% &
char22& *
.22* +
IsLetter22+ 3
)223 4
)224 5
{33 
return44 
Ok44 
(44 
$str44 A
)44A B
;44B C
}55 
if88 
(88 
string88 
.88 
IsNullOrWhiteSpace88 )
(88) *
cliente88* 1
.881 2
Cedula882 8
)888 9
)889 :
{99 
return:: 
Ok:: 
(:: 
$str:: 4
)::4 5
;::5 6
};; 
if<< 
(<< 
!<< 
cliente<< 
.<< 
Cedula<< 
.<<  
All<<  #
(<<# $
char<<$ (
.<<( )
IsDigit<<) 0
)<<0 1
)<<1 2
{== 
return>> 
Ok>> 
(>> 
$str>> @
)>>@ A
;>>A B
}?? 
if@@ 
(@@ 
!@@ 
EsCedulaValida@@ 
(@@  
cliente@@  '
.@@' (
Cedula@@( .
)@@. /
)@@/ 0
{AA 
returnBB 
OkBB 
(BB 
$strBB <
)BB< =
;BB= >
}CC 
ifGG 
(GG 
clienteGG 
.GG 
EdadGG 
<GG 
$numGG !
||GG" $
clienteGG% ,
.GG, -
EdadGG- 1
>GG2 3
$numGG4 6
)GG6 7
{HH 
returnII 
OkII 
(II 
$strII Y
)IIY Z
;IIZ [
}JJ 
varMM 
clienteExistenteMM  
=MM! "
awaitMM# (
_appDbContextMM) 6
.MM6 7
ClientesMM7 ?
.MM? @
FirstOrDefaultAsyncMM@ S
(MMS T
cMMT U
=>MMV X
cMMY Z
.MMZ [
CedulaMM[ a
==MMb d
clienteMMe l
.MMl m
CedulaMMm s
)MMs t
;MMt u
ifNN 
(NN 
clienteExistenteNN  
!=NN! #
nullNN$ (
)NN( )
{OO 
returnPP 
OkPP 
(PP 
$strPP D
)PPD E
;PPE F
}QQ 
_appDbContextSS 
.SS 
ClientesSS "
.SS" #
AddSS# &
(SS& '
clienteSS' .
)SS. /
;SS/ 0
awaitTT 
_appDbContextTT 
.TT  
SaveChangesAsyncTT  0
(TT0 1
)TT1 2
;TT2 3
returnUU 
OkUU 
(UU 
clienteUU 
)UU 
;UU 
}VV 	
[YY 	
HttpPutYY	 
(YY 
$strYY 
)YY 
]YY 
publicZZ 
asyncZZ 
TaskZZ 
<ZZ 
IActionResultZZ '
>ZZ' (
EditClienteZZ) 4
(ZZ4 5
intZZ5 8
idZZ9 ;
,ZZ; <
ClienteZZ= D
clienteZZE L
)ZZL M
{[[ 	
if\\ 
(\\ 
id\\ 
!=\\ 
cliente\\ 
.\\ 
Id\\  
)\\  !
return\\" (
Ok\\) +
(\\+ ,
$str\\, K
)\\K L
;\\L M
var^^ 
clienteExistente^^  
=^^! "
await^^# (
_appDbContext^^) 6
.^^6 7
Clientes^^7 ?
.^^? @
	FindAsync^^@ I
(^^I J
id^^J L
)^^L M
;^^M N
if__ 
(__ 
clienteExistente__  
==__! #
null__$ (
)__( )
return__* 0
Ok__1 3
(__3 4
$str__4 J
)__J K
;__K L
ifbb 
(bb 
stringbb 
.bb 
IsNullOrWhiteSpacebb )
(bb) *
clientebb* 1
.bb1 2
Nombrebb2 8
)bb8 9
)bb9 :
{cc 
returndd 
Okdd 
(dd 
$strdd 4
)dd4 5
;dd5 6
}ee 
ifff 
(ff 
!ff 
clienteff 
.ff 
Nombreff 
.ff  
Allff  #
(ff# $
charff$ (
.ff( )
IsLetterff) 1
)ff1 2
)ff2 3
{gg 
returnhh 
Okhh 
(hh 
$strhh ?
)hh? @
;hh@ A
}ii 
ifll 
(ll 
stringll 
.ll 
IsNullOrWhiteSpacell )
(ll) *
clientell* 1
.ll1 2
Apellidoll2 :
)ll: ;
)ll; <
{mm 
returnnn 
Oknn 
(nn 
$strnn 6
)nn6 7
;nn7 8
}oo 
ifpp 
(pp 
!pp 
clientepp 
.pp 
Apellidopp !
.pp! "
Allpp" %
(pp% &
charpp& *
.pp* +
IsLetterpp+ 3
)pp3 4
)pp4 5
{qq 
returnrr 
Okrr 
(rr 
$strrr A
)rrA B
;rrB C
}ss 
ifvv 
(vv 
stringvv 
.vv 
IsNullOrWhiteSpacevv )
(vv) *
clientevv* 1
.vv1 2
Cedulavv2 8
)vv8 9
)vv9 :
{ww 
returnxx 
Okxx 
(xx 
$strxx 4
)xx4 5
;xx5 6
}yy 
ifzz 
(zz 
!zz 
clientezz 
.zz 
Cedulazz 
.zz  
Allzz  #
(zz# $
charzz$ (
.zz( )
IsDigitzz) 0
)zz0 1
)zz1 2
{{{ 
return|| 
Ok|| 
(|| 
$str|| @
)||@ A
;||A B
}}} 
if~~ 
(~~ 
!~~ 
EsCedulaValida~~ 
(~~  
cliente~~  '
.~~' (
Cedula~~( .
)~~. /
)~~/ 0
{ 
return
ÄÄ 
Ok
ÄÄ 
(
ÄÄ 
$str
ÄÄ <
)
ÄÄ< =
;
ÄÄ= >
}
ÅÅ 
if
ÑÑ 
(
ÑÑ 
cliente
ÑÑ 
.
ÑÑ 
Edad
ÑÑ 
<
ÑÑ 
$num
ÑÑ !
||
ÑÑ" $
cliente
ÑÑ% ,
.
ÑÑ, -
Edad
ÑÑ- 1
>
ÑÑ2 3
$num
ÑÑ4 6
)
ÑÑ6 7
{
ÖÖ 
return
ÜÜ 
Ok
ÜÜ 
(
ÜÜ 
$str
ÜÜ Y
)
ÜÜY Z
;
ÜÜZ [
}
áá 
var
ää 
clienteConCedula
ää  
=
ää! "
await
ää# (
_appDbContext
ää) 6
.
ää6 7
Clientes
ää7 ?
.
ää? @!
FirstOrDefaultAsync
ää@ S
(
ääS T
c
ääT U
=>
ääV X
c
ääY Z
.
ääZ [
Cedula
ää[ a
==
ääb d
cliente
ääe l
.
ääl m
Cedula
ääm s
&&
äät v
c
ääw x
.
ääx y
Id
ääy {
!=
ää| ~
idää Å
)ääÅ Ç
;ääÇ É
if
ãã 
(
ãã 
clienteConCedula
ãã  
!=
ãã! #
null
ãã$ (
)
ãã( )
{
åå 
return
çç 
Ok
çç 
(
çç 
$str
çç F
)
ççF G
;
ççG H
}
éé 
clienteExistente
ëë 
.
ëë 
Nombre
ëë #
=
ëë$ %
cliente
ëë& -
.
ëë- .
Nombre
ëë. 4
;
ëë4 5
clienteExistente
íí 
.
íí 
Apellido
íí %
=
íí& '
cliente
íí( /
.
íí/ 0
Apellido
íí0 8
;
íí8 9
clienteExistente
ìì 
.
ìì 
Edad
ìì !
=
ìì" #
cliente
ìì$ +
.
ìì+ ,
Edad
ìì, 0
;
ìì0 1
clienteExistente
îî 
.
îî 
Cedula
îî #
=
îî$ %
cliente
îî& -
.
îî- .
Cedula
îî. 4
;
îî4 5
_appDbContext
ññ 
.
ññ 
Clientes
ññ "
.
ññ" #
Update
ññ# )
(
ññ) *
clienteExistente
ññ* :
)
ññ: ;
;
ññ; <
await
óó 
_appDbContext
óó 
.
óó  
SaveChangesAsync
óó  0
(
óó0 1
)
óó1 2
;
óó2 3
return
ôô 
Ok
ôô 
(
ôô 
clienteExistente
ôô &
)
ôô& '
;
ôô' (
}
öö 	
[
ùù 	

HttpDelete
ùù	 
(
ùù 
$str
ùù 
)
ùù 
]
ùù 
public
ûû 
async
ûû 
Task
ûû 
<
ûû 
IActionResult
ûû '
>
ûû' (
DeleteCliente
ûû) 6
(
ûû6 7
int
ûû7 :
id
ûû; =
)
ûû= >
{
üü 	
var
†† 
cliente
†† 
=
†† 
await
†† 
_appDbContext
††  -
.
††- .
Clientes
††. 6
.
††6 7
	FindAsync
††7 @
(
††@ A
id
††A C
)
††C D
;
††D E
if
°° 
(
°° 
cliente
°° 
==
°° 
null
°° 
)
°°  
return
°°! '
Ok
°°( *
(
°°* +
$str
°°+ A
)
°°A B
;
°°B C
var
££  
tieneReservaciones
££ "
=
££# $
await
££% *
_appDbContext
££+ 8
.
££8 9
Reservas
££9 A
.
££A B
AnyAsync
££B J
(
££J K
r
££K L
=>
££M O
r
££P Q
.
££Q R
Cliente
££R Y
.
££Y Z
Id
££Z \
==
££] _
id
££` b
)
££b c
;
££c d
if
§§ 
(
§§  
tieneReservaciones
§§ "
)
§§" #
{
•• 
return
¶¶ 
Ok
¶¶ 
(
¶¶ 
$str
¶¶ a
)
¶¶a b
;
¶¶b c
}
ßß 
_appDbContext
©© 
.
©© 
Clientes
©© "
.
©©" #
Remove
©©# )
(
©©) *
cliente
©©* 1
)
©©1 2
;
©©2 3
await
™™ 
_appDbContext
™™ 
.
™™  
SaveChangesAsync
™™  0
(
™™0 1
)
™™1 2
;
™™2 3
return
¨¨ 
Ok
¨¨ 
(
¨¨ 
new
¨¨ 
{
¨¨ 
message
¨¨ #
=
¨¨$ %
$"
¨¨& (
$str
¨¨( 7
{
¨¨7 8
id
¨¨8 :
}
¨¨: ;
$str
¨¨; [
"
¨¨[ \
}
¨¨] ^
)
¨¨^ _
;
¨¨_ `
}
≠≠ 	
private
±± 
static
±± 
bool
±± 
EsCedulaValida
±± *
(
±±* +
string
±±+ 1
cedula
±±2 8
)
±±8 9
{
≤≤ 	
if
≥≥ 
(
≥≥ 
cedula
≥≥ 
.
≥≥ 
Length
≥≥ 
!=
≥≥  
$num
≥≥! #
||
≥≥$ &
!
≥≥' (
cedula
≥≥( .
.
≥≥. /
All
≥≥/ 2
(
≥≥2 3
char
≥≥3 7
.
≥≥7 8
IsDigit
≥≥8 ?
)
≥≥? @
)
≥≥@ A
{
¥¥ 
return
µµ 
false
µµ 
;
µµ 
}
∂∂ 
int
∏∏ 
	provincia
∏∏ 
=
∏∏ 
int
∏∏ 
.
∏∏  
Parse
∏∏  %
(
∏∏% &
cedula
∏∏& ,
.
∏∏, -
	Substring
∏∏- 6
(
∏∏6 7
$num
∏∏7 8
,
∏∏8 9
$num
∏∏: ;
)
∏∏; <
)
∏∏< =
;
∏∏= >
if
∫∫ 
(
∫∫ 
(
∫∫ 
	provincia
∫∫ 
<
∫∫ 
$num
∫∫ 
||
∫∫ !
	provincia
∫∫" +
>
∫∫, -
$num
∫∫. 0
)
∫∫0 1
&&
∫∫2 4
	provincia
∫∫5 >
!=
∫∫? A
$num
∫∫B D
)
∫∫D E
{
ªª 
return
ºº 
false
ºº 
;
ºº 
}
ΩΩ 
int
¿¿ 
[
¿¿ 
]
¿¿ 
coeficientes
¿¿ 
=
¿¿  
{
¿¿! "
$num
¿¿# $
,
¿¿$ %
$num
¿¿& '
,
¿¿' (
$num
¿¿) *
,
¿¿* +
$num
¿¿, -
,
¿¿- .
$num
¿¿/ 0
,
¿¿0 1
$num
¿¿2 3
,
¿¿3 4
$num
¿¿5 6
,
¿¿6 7
$num
¿¿8 9
,
¿¿9 :
$num
¿¿; <
}
¿¿= >
;
¿¿> ?
int
¡¡ 
suma
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
for
√√ 
(
√√ 
int
√√ 
i
√√ 
=
√√ 
$num
√√ 
;
√√ 
i
√√ 
<
√√ 
coeficientes
√√  ,
.
√√, -
Length
√√- 3
;
√√3 4
i
√√5 6
++
√√6 8
)
√√8 9
{
ƒƒ 
int
≈≈ 
valor
≈≈ 
=
≈≈ 
coeficientes
≈≈ (
[
≈≈( )
i
≈≈) *
]
≈≈* +
*
≈≈, -
int
≈≈. 1
.
≈≈1 2
Parse
≈≈2 7
(
≈≈7 8
cedula
≈≈8 >
[
≈≈> ?
i
≈≈? @
]
≈≈@ A
.
≈≈A B
ToString
≈≈B J
(
≈≈J K
)
≈≈K L
)
≈≈L M
;
≈≈M N
suma
∆∆ 
+=
∆∆ 
valor
∆∆ 
>=
∆∆  
$num
∆∆! #
?
∆∆$ %
valor
∆∆& +
-
∆∆, -
$num
∆∆. /
:
∆∆0 1
valor
∆∆2 7
;
∆∆7 8
}
«« 
int
…… 
digitoVerificador
…… !
=
……" #
int
……$ '
.
……' (
Parse
……( -
(
……- .
cedula
……. 4
[
……4 5
$num
……5 6
]
……6 7
.
……7 8
ToString
……8 @
(
……@ A
)
……A B
)
……B C
;
……C D
int
   
residuo
   
=
   
suma
   
%
    
$num
  ! #
;
  # $
int
ÀÀ 
	resultado
ÀÀ 
=
ÀÀ 
residuo
ÀÀ #
==
ÀÀ$ &
$num
ÀÀ' (
?
ÀÀ) *
$num
ÀÀ+ ,
:
ÀÀ- .
$num
ÀÀ/ 1
-
ÀÀ2 3
residuo
ÀÀ4 ;
;
ÀÀ; <
return
ÕÕ 
	resultado
ÕÕ 
==
ÕÕ 
digitoVerificador
ÕÕ  1
;
ÕÕ1 2
}
ŒŒ 	
}
–– 
}—— ˛,
hC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\AppDBContext.cs
	namespace 	
prueba
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{ 
public 
AppDBContext 
( 
DbContextOptions ,
<, -
AppDBContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{T U
}V W
public

 
DbSet

 
<

 
Cliente

 
>

 
Clientes

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
DbSet 
< 

Habitacion 
>  
Habitaciones! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Reserva 
> 
Reservas &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ServicioAdicional &
>& ' 
ServiciosAdicionales( <
{= >
get? B
;B C
setD G
;G H
}I J
} 
public 

class 
Cliente 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
required 
string 
Nombre %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
required 
string 
Apellido '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
int 
? 
Edad 
{ 
get 
; 
set  #
;# $
}% &
public 
required 
string 
Cedula %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class 

Habitacion 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
	Capacidad 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
? 
NumeroDeHabitacion &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[   	
JsonRequired  	 
]   
public   
decimal   %
Costo  & +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
int!! 
?!! 
Piso!! 
{!! 
get!! 
;!! 
set!!  #
;!!# $
}!!% &
}"" 
public$$ 

class$$ 
Reserva$$ 
{%% 
public&& 
required&& 
int&& 
Id&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 
required'' 
Cliente'' 
Cliente''  '
{''( )
get''* -
;''- .
set''/ 2
;''2 3
}''4 5
=''6 7
null''8 <
!''< =
;''= >
public(( 
required(( 

Habitacion(( "

Habitacion((# -
{((. /
get((0 3
;((3 4
set((5 8
;((8 9
}((: ;
=((< =
null((> B
!((B C
;((C D
[)) 	
JsonRequired))	 
])) 
public)) 
DateTime)) &
FechaDeReserva))' 5
{))6 7
get))8 ;
;)); <
set))= @
;))@ A
}))B C
[** 	
JsonRequired**	 
]** 
public** 
DateTime** &
FechaDeInicio**' 4
{**5 6
get**7 :
;**: ;
set**< ?
;**? @
}**A B
[++ 	
JsonRequired++	 
]++ 
public++ 
DateTime++ &

FechaDeFin++' 1
{++2 3
get++4 7
;++7 8
set++9 <
;++< =
}++> ?
},, 
public.. 

class.. 
ServicioAdicional.. "
{// 
public00 
required00 
int00 
Id00 
{00  
get00! $
;00$ %
set00& )
;00) *
}00+ ,
public11 
required11 
string11 
Descripcion11 *
{11+ ,
get11- 0
;110 1
set112 5
;115 6
}117 8
=119 :
null11; ?
!11? @
;11@ A
[22 	
JsonRequired22	 
]22 
public22 
decimal22 %
Costo22& +
{22, -
get22. 1
;221 2
set223 6
;226 7
}228 9
public33 
required33 
Reserva33 
Reserva33  '
{33( )
get33* -
;33- .
set33/ 2
;332 3
}334 5
=336 7
null338 <
!33< =
;33= >
}44 
}55 