˜
cC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Env 
. 
Load 
( 	
)	 

;
 
var		 
dbServer		 
=		 
Environment		 
.		 "
GetEnvironmentVariable		 1
(		1 2
$str		2 =
)		= >
;		> ?
var

 

dbDatabase

 
=

 
Environment

 
.

 "
GetEnvironmentVariable

 3
(

3 4
$str

4 A
)

A B
;

B C
var 
dbUser 

= 
Environment 
. "
GetEnvironmentVariable /
(/ 0
$str0 9
)9 :
;: ;
var 

dbPassword 
= 
Environment 
. "
GetEnvironmentVariable 3
(3 4
$str4 A
)A B
;B C
var 
connectionString 
= 
$" 
$str  
{  !
dbServer! )
}) *
$str* +
"+ ,
+- .
$" 
$str "
{" #

dbDatabase# -
}- .
$str. /
"/ 0
+1 2
$" 
$str !
{! "
dbUser" (
}( )
$str) *
"* +
+, -
$" 
$str "
{" #

dbPassword# -
}- .
$str. /
"/ 0
+1 2
$" 
$str S
"S T
;T U
builder 
. 
Configuration 
[ 
$str ;
]; <
== >
connectionString? O
;O P
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options7 >
.> ?
UseSqlServer? K
(K L
builderL S
.S T
ConfigurationT a
.a b
GetConnectionStringb u
(u v
$str	v â
)
â ä
)
ä ã
)
ã å
;
å ç
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
app 
. 
Environment 
. 
IsDevelopment 
( 
) 
;  
app   
.   

UseSwagger   
(   
)   
;   
app!! 
.!! 
UseSwaggerUI!! 
(!! 
)!! 
;!! 
app$$ 
.$$ 
UseHttpsRedirection$$ 
($$ 
)$$ 
;$$ 
app%% 
.%% 
UseAuthorization%% 
(%% 
)%% 
;%% 
app&& 
.&& 
MapControllers&& 
(&& 
)&& 
;&& 
await'' 
app'' 	
.''	 

RunAsync''
 
('' 
)'' 
;'' …j
ÇC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Migrations\20250120230010_InitalCreate.cs
	namespace 	
prueba
 
. 

Migrations 
{ 
public 

partial 
class 
InitalCreate %
:& '
	Migration( 1
{ 
private 
const 
string 
SqlServerIdentity .
=/ 0
$str1 E
;E F
private 
const 
string 
NvarcharMax (
=) *
$str+ :
;: ;
private 
const 
string 
ReservasTableName .
=/ 0
$str1 ;
;; <
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
falseS X
)X Y
,Y Z
Apellido 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
,[ \
Edad 
= 
table  
.  !
Column! '
<' (
int( +
>+ ,
(, -
type- 1
:1 2
$str3 8
,8 9
nullable: B
:B C
trueD H
)H I
,I J
Cedula 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
nullableI Q
:Q R
falseS X
)X Y
} 
, 
constraints 
: 
table "
=># %
{   
table!! 
.!! 

PrimaryKey!! $
(!!$ %
$str!!% 2
,!!2 3
x!!4 5
=>!!6 8
x!!9 :
.!!: ;
Id!!; =
)!!= >
;!!> ?
}"" 
)"" 
;"" 
migrationBuilder$$ 
.$$ 
CreateTable$$ (
($$( )
name%% 
:%% 
$str%% $
,%%$ %
columns&& 
:&& 
table&& 
=>&& !
new&&" %
{'' 
Id(( 
=(( 
table(( 
.(( 
Column(( %
<((% &
int((& )
>(() *
(((* +
type((+ /
:((/ 0
$str((1 6
,((6 7
nullable((8 @
:((@ A
false((B G
)((G H
.)) 

Annotation)) #
())# $
$str))$ 8
,))8 9
$str)): @
)))@ A
,))A B
	Capacidad** 
=** 
table**  %
.**% &
Column**& ,
<**, -
int**- 0
>**0 1
(**1 2
type**2 6
:**6 7
$str**8 =
,**= >
nullable**? G
:**G H
true**I M
)**M N
,**N O
NumeroDeHabitacion++ &
=++' (
table++) .
.++. /
Column++/ 5
<++5 6
int++6 9
>++9 :
(++: ;
type++; ?
:++? @
$str++A F
,++F G
nullable++H P
:++P Q
true++R V
)++V W
,++W X
Costo,, 
=,, 
table,, !
.,,! "
Column,," (
<,,( )
decimal,,) 0
>,,0 1
(,,1 2
type,,2 6
:,,6 7
$str,,8 G
,,,G H
nullable,,I Q
:,,Q R
false,,S X
),,X Y
,,,Y Z
Piso-- 
=-- 
table--  
.--  !
Column--! '
<--' (
int--( +
>--+ ,
(--, -
type--- 1
:--1 2
$str--3 8
,--8 9
nullable--: B
:--B C
true--D H
)--H I
}.. 
,.. 
constraints// 
:// 
table// "
=>//# %
{00 
table11 
.11 

PrimaryKey11 $
(11$ %
$str11% 6
,116 7
x118 9
=>11: <
x11= >
.11> ?
Id11? A
)11A B
;11B C
}22 
)22 
;22 
migrationBuilder44 
.44 
CreateTable44 (
(44( )
name55 
:55 
ReservasTableName55 '
,55' (
columns66 
:66 
table66 
=>66 !
new66" %
{77 
Id88 
=88 
table88 
.88 
Column88 %
<88% &
int88& )
>88) *
(88* +
type88+ /
:88/ 0
$str881 6
,886 7
nullable888 @
:88@ A
false88B G
)88G H
.99 

Annotation99 #
(99# $
SqlServerIdentity99$ 5
,995 6
$str997 =
)99= >
,99> ?
	ClienteId:: 
=:: 
table::  %
.::% &
Column::& ,
<::, -
int::- 0
>::0 1
(::1 2
type::2 6
:::6 7
$str::8 =
,::= >
nullable::? G
:::G H
false::I N
)::N O
,::O P
HabitacionId;;  
=;;! "
table;;# (
.;;( )
Column;;) /
<;;/ 0
int;;0 3
>;;3 4
(;;4 5
type;;5 9
:;;9 :
$str;;; @
,;;@ A
nullable;;B J
:;;J K
false;;L Q
);;Q R
,;;R S
FechaDeReserva<< "
=<<# $
table<<% *
.<<* +
Column<<+ 1
<<<1 2
DateTime<<2 :
><<: ;
(<<; <
type<<< @
:<<@ A
$str<<B M
,<<M N
nullable<<O W
:<<W X
false<<Y ^
)<<^ _
,<<_ `
FechaDeInicio== !
===" #
table==$ )
.==) *
Column==* 0
<==0 1
DateTime==1 9
>==9 :
(==: ;
type==; ?
:==? @
$str==A L
,==L M
nullable==N V
:==V W
false==X ]
)==] ^
,==^ _

FechaDeFin>> 
=>>  
table>>! &
.>>& '
Column>>' -
<>>- .
DateTime>>. 6
>>>6 7
(>>7 8
type>>8 <
:>>< =
$str>>> I
,>>I J
nullable>>K S
:>>S T
false>>U Z
)>>Z [
}?? 
,?? 
constraints@@ 
:@@ 
table@@ "
=>@@# %
{AA 
tableBB 
.BB 

PrimaryKeyBB $
(BB$ %
$strBB% 2
,BB2 3
xBB4 5
=>BB6 8
xBB9 :
.BB: ;
IdBB; =
)BB= >
;BB> ?
tableCC 
.CC 

ForeignKeyCC $
(CC$ %
nameDD 
:DD 
$strDD >
,DD> ?
columnEE 
:EE 
xEE  !
=>EE" $
xEE% &
.EE& '
	ClienteIdEE' 0
,EE0 1
principalTableFF &
:FF& '
$strFF( 2
,FF2 3
principalColumnGG '
:GG' (
$strGG) -
,GG- .
onDeleteHH  
:HH  !
ReferentialActionHH" 3
.HH3 4
CascadeHH4 ;
)HH; <
;HH< =
tableII 
.II 

ForeignKeyII $
(II$ %
nameJJ 
:JJ 
$strJJ E
,JJE F
columnKK 
:KK 
xKK  !
=>KK" $
xKK% &
.KK& '
HabitacionIdKK' 3
,KK3 4
principalTableLL &
:LL& '
$strLL( 6
,LL6 7
principalColumnMM '
:MM' (
$strMM) -
,MM- .
onDeleteNN  
:NN  !
ReferentialActionNN" 3
.NN3 4
CascadeNN4 ;
)NN; <
;NN< =
}OO 
)OO 
;OO 
migrationBuilderQQ 
.QQ 
CreateTableQQ (
(QQ( )
nameRR 
:RR 
$strRR ,
,RR, -
columnsSS 
:SS 
tableSS 
=>SS !
newSS" %
{TT 
IdUU 
=UU 
tableUU 
.UU 
ColumnUU %
<UU% &
intUU& )
>UU) *
(UU* +
typeUU+ /
:UU/ 0
$strUU1 6
,UU6 7
nullableUU8 @
:UU@ A
falseUUB G
)UUG H
.VV 

AnnotationVV #
(VV# $
SqlServerIdentityVV$ 5
,VV5 6
$strVV7 =
)VV= >
,VV> ?
DescripcionWW 
=WW  !
tableWW" '
.WW' (
ColumnWW( .
<WW. /
stringWW/ 5
>WW5 6
(WW6 7
typeWW7 ;
:WW; <
$strWW= L
,WWL M
nullableWWN V
:WWV W
falseWWX ]
)WW] ^
,WW^ _
CostoXX 
=XX 
tableXX !
.XX! "
ColumnXX" (
<XX( )
decimalXX) 0
>XX0 1
(XX1 2
typeXX2 6
:XX6 7
$strXX8 G
,XXG H
nullableXXI Q
:XXQ R
falseXXS X
)XXX Y
,XXY Z
	ReservaIdYY 
=YY 
tableYY  %
.YY% &
ColumnYY& ,
<YY, -
intYY- 0
>YY0 1
(YY1 2
typeYY2 6
:YY6 7
$strYY8 =
,YY= >
nullableYY? G
:YYG H
falseYYI N
)YYN O
}ZZ 
,ZZ 
constraints[[ 
:[[ 
table[[ "
=>[[# %
{\\ 
table]] 
.]] 

PrimaryKey]] $
(]]$ %
$str]]% >
,]]> ?
x]]@ A
=>]]B D
x]]E F
.]]F G
Id]]G I
)]]I J
;]]J K
table^^ 
.^^ 

ForeignKey^^ $
(^^$ %
name__ 
:__ 
$str__ J
,__J K
column`` 
:`` 
x``  !
=>``" $
x``% &
.``& '
	ReservaId``' 0
,``0 1
principalTableaa &
:aa& '
ReservasTableNameaa( 9
,aa9 :
principalColumnbb '
:bb' (
$strbb) -
,bb- .
onDeletecc  
:cc  !
ReferentialActioncc" 3
.cc3 4
Cascadecc4 ;
)cc; <
;cc< =
}dd 
)dd 
;dd 
migrationBuilderff 
.ff 
CreateIndexff (
(ff( )
namegg 
:gg 
$strgg -
,gg- .
tablehh 
:hh 
ReservasTableNamehh (
,hh( )
columnii 
:ii 
$strii #
)ii# $
;ii$ %
migrationBuilderkk 
.kk 
CreateIndexkk (
(kk( )
namell 
:ll 
$strll 0
,ll0 1
tablemm 
:mm 
ReservasTableNamemm (
,mm( )
columnnn 
:nn 
$strnn &
)nn& '
;nn' (
migrationBuilderpp 
.pp 
CreateIndexpp (
(pp( )
nameqq 
:qq 
$strqq 9
,qq9 :
tablerr 
:rr 
$strrr -
,rr- .
columnss 
:ss 
$strss #
)ss# $
;ss$ %
}tt 	
	protectedww 
overrideww 
voidww 
Downww  $
(ww$ %
MigrationBuilderww% 5
migrationBuilderww6 F
)wwF G
{xx 	
migrationBuilderyy 
.yy 
	DropTableyy &
(yy& '
namezz 
:zz 
$strzz ,
)zz, -
;zz- .
migrationBuilder|| 
.|| 
	DropTable|| &
(||& '
name}} 
:}} 
ReservasTableName}} '
)}}' (
;}}( )
migrationBuilder 
. 
	DropTable &
(& '
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ  
)
ÄÄ  !
;
ÄÄ! "
migrationBuilder
ÇÇ 
.
ÇÇ 
	DropTable
ÇÇ &
(
ÇÇ& '
name
ÉÉ 
:
ÉÉ 
$str
ÉÉ $
)
ÉÉ$ %
;
ÉÉ% &
}
ÑÑ 	
}
ÖÖ 
}ÜÜ £T
ÉC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ServicioAdicionalController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 '
ServicioAdicionalController

 ,
:

- .
ControllerBase

/ =
{ 
private 
readonly 
AppDBContext %
_appDbContext& 3
;3 4
public '
ServicioAdicionalController *
(* +
AppDBContext+ 7
appDbContext8 D
)D E
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (#
GetServiciosAdicionales) @
(@ A
)A B
{ 	
var 
	servicios 
= 
await !
_appDbContext" /
./ 0 
ServiciosAdicionales0 D
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
)' (
. 
ThenInclude 
( 
r 
=> !
r" #
.# $
Cliente$ +
)+ ,
. 
Include 
( 
s 
=> 
s 
.  
Reserva  '
.' (

Habitacion( 2
)2 3
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
	servicios 
)  
;  !
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' ( 
GetServicioAdicional) =
(= >
int> A
idB D
)D E
{   	
var!! 
servicio!! 
=!! 
await!!  
_appDbContext!!! .
.!!. / 
ServiciosAdicionales!!/ C
."" 
Include"" 
("" 
s"" 
=>"" 
s"" 
.""  
Reserva""  '
)""' (
.## 
ThenInclude## 
(## 
r## 
=>## !
r##" #
.### $
Cliente##$ +
)##+ ,
.$$ 
Include$$ 
($$ 
s$$ 
=>$$ 
s$$ 
.$$  
Reserva$$  '
.$$' (

Habitacion$$( 2
)$$2 3
.%% 
FirstOrDefaultAsync%% $
(%%$ %
s%%% &
=>%%' )
s%%* +
.%%+ ,
Id%%, .
==%%/ 1
id%%2 4
)%%4 5
;%%5 6
if'' 
('' 
servicio'' 
=='' 
null''  
)''  !
return''" (
Ok'') +
(''+ ,
$str'', C
)''C D
;''D E
return)) 
Ok)) 
()) 
servicio)) 
))) 
;))  
}** 	
[,, 	
HttpPost,,	 
],, 
public-- 
async-- 
Task-- 
<-- 
IActionResult-- '
>--' (#
CreateServicioAdicional--) @
(--@ A
ServicioAdicional--A R
servicio--S [
)--[ \
{.. 	
if// 
(// 
string// 
.// 
IsNullOrWhiteSpace// )
(//) *
servicio//* 2
.//2 3
Descripcion//3 >
)//> ?
)//? @
{00 
return11 
Ok11 
(11 
$str11 F
)11F G
;11G H
}22 
if44 
(44 
!44 
servicio44 
.44 
Descripcion44 %
.44% &
All44& )
(44) *
char44* .
.44. /
IsLetter44/ 7
)447 8
)448 9
{55 
return66 
Ok66 
(66 
$str66 D
)66D E
;66E F
}77 
if99 
(99 
servicio99 
.99 
Costo99 
<=99 !
$num99" #
||99$ &
servicio99' /
.99/ 0
Costo990 5
>996 7
$num998 ;
)99; <
{:: 
return;; 
Ok;; 
(;; 
$str;; ;
);;; <
;;;< =
}<< 
var>> 
reserva>> 
=>> 
await>> 
_appDbContext>>  -
.>>- .
Reservas>>. 6
.>>6 7
	FindAsync>>7 @
(>>@ A
servicio>>A I
.>>I J
Reserva>>J Q
.>>Q R
Id>>R T
)>>T U
;>>U V
if?? 
(?? 
reserva?? 
==?? 
null?? 
)??  
{@@ 
returnAA 
OkAA 
(AA 
$strAA 9
)AA9 :
;AA: ;
}BB 
servicioDD 
.DD 
ReservaDD 
=DD 
reservaDD &
;DD& '
_appDbContextFF 
.FF  
ServiciosAdicionalesFF .
.FF. /
AddFF/ 2
(FF2 3
servicioFF3 ;
)FF; <
;FF< =
awaitGG 
_appDbContextGG 
.GG  
SaveChangesAsyncGG  0
(GG0 1
)GG1 2
;GG2 3
returnII 
OkII 
(II 
servicioII 
)II 
;II  
}KK 	
[MM 	
HttpPutMM	 
(MM 
$strMM 
)MM 
]MM 
publicNN 
asyncNN 
TaskNN 
<NN 
IActionResultNN '
>NN' (!
EditServicioAdicionalNN) >
(NN> ?
intNN? B
idNNC E
,NNE F
ServicioAdicionalNNG X
servicioNNY a
)NNa b
{OO 	
ifPP 
(PP 
idPP 
!=PP 
servicioPP 
.PP 
IdPP !
)PP! "
returnPP# )
OkPP* ,
(PP, -
$strPP- W
)PPW X
;PPX Y
varRR 
servicioExistenteRR !
=RR" #
awaitRR$ )
_appDbContextRR* 7
.RR7 8 
ServiciosAdicionalesRR8 L
.SS 
IncludeSS 
(SS 
sSS 
=>SS 
sSS 
.SS  
ReservaSS  '
)SS' (
.TT 
FirstOrDefaultAsyncTT $
(TT$ %
sTT% &
=>TT' )
sTT* +
.TT+ ,
IdTT, .
==TT/ 1
idTT2 4
)TT4 5
;TT5 6
ifVV 
(VV 
servicioExistenteVV !
==VV" $
nullVV% )
)VV) *
returnVV+ 1
OkVV2 4
(VV4 5
$strVV5 V
)VVV W
;VVW X
ifXX 
(XX 
stringXX 
.XX 
IsNullOrWhiteSpaceXX )
(XX) *
servicioXX* 2
.XX2 3
DescripcionXX3 >
)XX> ?
)XX? @
{YY 
returnZZ 
OkZZ 
(ZZ 
$strZZ F
)ZZF G
;ZZG H
}[[ 
if]] 
(]] 
servicio]] 
.]] 
Costo]] 
<=]] !
$num]]" #
||]]$ &
servicio]]' /
.]]/ 0
Costo]]0 5
>]]6 7
$num]]8 ;
)]]; <
{^^ 
return__ 
Ok__ 
(__ 
$str__ ;
)__; <
;__< =
}`` 
varbb 
reservabb 
=bb 
awaitbb 
_appDbContextbb  -
.bb- .
Reservasbb. 6
.bb6 7
	FindAsyncbb7 @
(bb@ A
serviciobbA I
.bbI J
ReservabbJ Q
.bbQ R
IdbbR T
)bbT U
;bbU V
ifcc 
(cc 
reservacc 
==cc 
nullcc 
)cc  
{dd 
returnee 
Okee 
(ee 
$stree :
)ee: ;
;ee; <
}ff 
servicioExistentehh 
.hh 
Descripcionhh )
=hh* +
serviciohh, 4
.hh4 5
Descripcionhh5 @
;hh@ A
servicioExistenteii 
.ii 
Costoii #
=ii$ %
servicioii& .
.ii. /
Costoii/ 4
;ii4 5
servicioExistentejj 
.jj 
Reservajj %
=jj& '
reservajj( /
;jj/ 0
_appDbContextll 
.ll  
ServiciosAdicionalesll .
.ll. /
Updatell/ 5
(ll5 6
servicioExistentell6 G
)llG H
;llH I
awaitmm 
_appDbContextmm 
.mm  
SaveChangesAsyncmm  0
(mm0 1
)mm1 2
;mm2 3
returnoo 
Okoo 
(oo 
servicioExistenteoo '
)oo' (
;oo( )
}pp 	
[rr 	

HttpDeleterr	 
(rr 
$strrr 
)rr 
]rr 
publicss 
asyncss 
Taskss 
<ss 
IActionResultss '
>ss' (#
DeleteServicioAdicionalss) @
(ss@ A
intssA D
idssE G
)ssG H
{tt 	
varuu 
serviciouu 
=uu 
awaituu  
_appDbContextuu! .
.uu. / 
ServiciosAdicionalesuu/ C
.uuC D
	FindAsyncuuD M
(uuM N
iduuN P
)uuP Q
;uuQ R
ifvv 
(vv 
serviciovv 
==vv 
nullvv  
)vv  !
returnvv" (
Okvv) +
(vv+ ,
$strvv, M
)vvM N
;vvN O
_appDbContextxx 
.xx  
ServiciosAdicionalesxx .
.xx. /
Removexx/ 5
(xx5 6
servicioxx6 >
)xx> ?
;xx? @
awaityy 
_appDbContextyy 
.yy  
SaveChangesAsyncyy  0
(yy0 1
)yy1 2
;yy2 3
return{{ 
Ok{{ 
({{ 
new{{ 
{{{ 
message{{ #
={{$ %
$"{{& (
$str{{( B
{{{B C
id{{C E
}{{E F
$str{{F ^
"{{^ _
}{{` a
){{a b
;{{b c
}|| 	
}}} 
}~~ ⁄b
yC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ReservaController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
ReservaController "
:# $
ControllerBase% 3
{ 
private 
readonly 
AppDBContext %
_appDbContext& 3
;3 4
public 
ReservaController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetReservas) 4
(4 5
)5 6
{ 	
var 
reservas 
= 
await  
_appDbContext! .
.. /
Reservas/ 7
. 
Include 
( 
r 
=> 
r 
.  
Cliente  '
)' (
. 
Include 
( 
r 
=> 
r 
.  

Habitacion  *
)* +
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
reservas 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetReserva) 3
(3 4
int4 7
id8 :
): ;
{   	
var!! 
reserva!! 
=!! 
await!! 
_appDbContext!!  -
.!!- .
Reservas!!. 6
."" 
Include"" 
("" 
r"" 
=>"" 
r"" 
.""  
Cliente""  '
)""' (
.## 
Include## 
(## 
r## 
=>## 
r## 
.##  

Habitacion##  *
)##* +
.$$ 
FirstOrDefaultAsync$$ $
($$$ %
r$$% &
=>$$' )
r$$* +
.$$+ ,
Id$$, .
==$$/ 1
id$$2 4
)$$4 5
;$$5 6
if&& 
(&& 
reserva&& 
==&& 
null&& 
)&&  
return&&! '
Ok&&( *
(&&* +
$str&&+ A
)&&A B
;&&B C
return(( 
Ok(( 
((( 
reserva(( 
)(( 
;(( 
})) 	
[++ 	
HttpPost++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (
CreateReserva,,) 6
(,,6 7
Reserva,,7 >
reserva,,? F
),,F G
{-- 	
var.. 
validationResult..  
=..! "
await..# (
validar..) 0
(..0 1
reserva..1 8
)..8 9
;..9 :
if// 
(// 
validationResult//  
!=//! #
null//$ (
)//( )
{00 
return11 
validationResult11 '
;11' (
}22 
_appDbContext44 
.44 
Reservas44 "
.44" #
Add44# &
(44& '
reserva44' .
)44. /
;44/ 0
await55 
_appDbContext55 
.55  
SaveChangesAsync55  0
(550 1
)551 2
;552 3
return77 
Ok77 
(77 
reserva77 
)77 
;77 
}99 	
[;; 	
HttpPut;;	 
(;; 
$str;; 
);; 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
EditReserva<<) 4
(<<4 5
int<<5 8
id<<9 ;
,<<; <
Reserva<<= D
reserva<<E L
)<<L M
{== 	
if>> 
(>> 
id>> 
!=>> 
reserva>> 
.>> 
Id>>  
)>>  !
return>>" (
Ok>>) +
(>>+ ,
$str>>, M
)>>M N
;>>N O
var@@ 
reservaExistente@@  
=@@! "
await@@# (
_appDbContext@@) 6
.@@6 7
Reservas@@7 ?
.AA 
IncludeAA 
(AA 
rAA 
=>AA 
rAA 
.AA  
ClienteAA  '
)AA' (
.BB 
IncludeBB 
(BB 
rBB 
=>BB 
rBB 
.BB  

HabitacionBB  *
)BB* +
.CC 
FirstOrDefaultAsyncCC $
(CC$ %
rCC% &
=>CC' )
rCC* +
.CC+ ,
IdCC, .
==CC/ 1
idCC2 4
)CC4 5
;CC5 6
ifEE 
(EE 
reservaExistenteEE  
==EE! #
nullEE$ (
)EE( )
returnEE* 0
OkEE1 3
(EE3 4
$strEE4 J
)EEJ K
;EEK L
varGG 
validationResultGG  
=GG! "
awaitGG# (
validarGG) 0
(GG0 1
reservaGG1 8
,GG8 9
excludeReservaIdGG: J
:GGJ K
idGGL N
)GGN O
;GGO P
ifHH 
(HH 
validationResultHH  
!=HH! #
nullHH$ (
)HH( )
{II 
returnJJ 
validationResultJJ '
;JJ' (
}KK 
reservaExistenteMM 
.MM 
ClienteMM $
=MM% &
reservaMM' .
.MM. /
ClienteMM/ 6
;MM6 7
reservaExistenteNN 
.NN 

HabitacionNN '
=NN( )
reservaNN* 1
.NN1 2

HabitacionNN2 <
;NN< =
reservaExistenteOO 
.OO 
FechaDeReservaOO +
=OO, -
reservaOO. 5
.OO5 6
FechaDeReservaOO6 D
;OOD E
reservaExistentePP 
.PP 
FechaDeInicioPP *
=PP+ ,
reservaPP- 4
.PP4 5
FechaDeInicioPP5 B
;PPB C
reservaExistenteQQ 
.QQ 

FechaDeFinQQ '
=QQ( )
reservaQQ* 1
.QQ1 2

FechaDeFinQQ2 <
;QQ< =
_appDbContextSS 
.SS 
ReservasSS "
.SS" #
UpdateSS# )
(SS) *
reservaExistenteSS* :
)SS: ;
;SS; <
awaitTT 
_appDbContextTT 
.TT  
SaveChangesAsyncTT  0
(TT0 1
)TT1 2
;TT2 3
returnVV 
OkVV 
(VV 
reservaExistenteVV &
)VV& '
;VV' (
}WW 	
[YY 	

HttpDeleteYY	 
(YY 
$strYY 
)YY 
]YY 
publicZZ 
asyncZZ 
TaskZZ 
<ZZ 
IActionResultZZ '
>ZZ' (
DeleteReservaZZ) 6
(ZZ6 7
intZZ7 :
idZZ; =
)ZZ= >
{[[ 	
var\\ 
reserva\\ 
=\\ 
await\\ 
_appDbContext\\  -
.\\- .
Reservas\\. 6
.\\6 7
	FindAsync\\7 @
(\\@ A
id\\A C
)\\C D
;\\D E
if]] 
(]] 
reserva]] 
==]] 
null]] 
)]]  
return]]! '
Ok]]( *
(]]* +
$str]]+ A
)]]A B
;]]B C
_appDbContext__ 
.__ 
Reservas__ "
.__" #
Remove__# )
(__) *
reserva__* 1
)__1 2
;__2 3
await`` 
_appDbContext`` 
.``  
SaveChangesAsync``  0
(``0 1
)``1 2
;``2 3
returnbb 
Okbb 
(bb 
newbb 
{bb 
messagebb #
=bb$ %
$"bb& (
$strbb( 7
{bb7 8
idbb8 :
}bb: ;
$strbb; S
"bbS T
}bbU V
)bbV W
;bbW X
}cc 	
privateee 
asyncee 
Taskee 
<ee 
IActionResultee (
?ee( )
>ee) *
validaree+ 2
(ee2 3
Reservaee3 :
reservaee; B
,eeB C
inteeD G
?eeG H
excludeReservaIdeeI Y
=eeZ [
nullee\ `
)ee` a
{ff 	
vargg 
clientegg 
=gg 
awaitgg 
_appDbContextgg  -
.gg- .
Clientesgg. 6
.gg6 7
	FindAsyncgg7 @
(gg@ A
reservaggA H
.ggH I
ClienteggI P
.ggP Q
IdggQ S
)ggS T
;ggT U
varhh 

habitacionhh 
=hh 
awaithh "
_appDbContexthh# 0
.hh0 1
Habitacioneshh1 =
.hh= >
	FindAsynchh> G
(hhG H
reservahhH O
.hhO P

HabitacionhhP Z
.hhZ [
Idhh[ ]
)hh] ^
;hh^ _
ifjj 
(jj 

habitacionjj 
==jj 
nulljj "
)jj" #
{kk 
returnll 
Okll 
(ll 
$strll 0
)ll0 1
;ll1 2
}mm 
ifoo 
(oo 
clienteoo 
==oo 
nulloo 
)oo  
{pp 
returnqq 
Okqq 
(qq 
$strqq -
)qq- .
;qq. /
}rr 
iftt 
(tt 
reservatt 
.tt 
FechaDeIniciott %
<tt& '
reservatt( /
.tt/ 0
FechaDeReservatt0 >
)tt> ?
{uu 
returnvv 
Okvv 
(vv 
$strvv Z
)vvZ [
;vv[ \
}ww 
ifyy 
(yy 
reservayy 
.yy 

FechaDeFinyy "
<=yy# %
reservayy& -
.yy- .
FechaDeInicioyy. ;
)yy; <
{zz 
return{{ 
Ok{{ 
({{ 
$str{{ S
){{S T
;{{T U
}|| 
var~~ 
	conflicto~~ 
=~~ 
await~~ !
_appDbContext~~" /
.~~/ 0
Reservas~~0 8
.~~8 9
AnyAsync~~9 A
( 
r 
=> 
r 
. 

Habitacion "
." #
Id# %
==& (

habitacion) 3
.3 4
Id4 6
&&7 9
(
ÄÄ 
!
ÄÄ 
excludeReservaId
ÄÄ "
.
ÄÄ" #
HasValue
ÄÄ# +
||
ÄÄ, .
r
ÄÄ/ 0
.
ÄÄ0 1
Id
ÄÄ1 3
!=
ÄÄ4 6
excludeReservaId
ÄÄ7 G
)
ÄÄG H
&&
ÄÄI K
(
ÅÅ 
(
ÅÅ 
reserva
ÅÅ 
.
ÅÅ 
FechaDeInicio
ÅÅ '
>=
ÅÅ( *
r
ÅÅ+ ,
.
ÅÅ, -
FechaDeInicio
ÅÅ- :
&&
ÅÅ; =
reserva
ÅÅ> E
.
ÅÅE F
FechaDeInicio
ÅÅF S
<
ÅÅT U
r
ÅÅV W
.
ÅÅW X

FechaDeFin
ÅÅX b
)
ÅÅb c
||
ÅÅd f
(
ÇÇ 
reserva
ÇÇ 
.
ÇÇ 

FechaDeFin
ÇÇ #
>
ÇÇ$ %
r
ÇÇ& '
.
ÇÇ' (
FechaDeInicio
ÇÇ( 5
&&
ÇÇ6 8
reserva
ÇÇ9 @
.
ÇÇ@ A

FechaDeFin
ÇÇA K
<=
ÇÇL N
r
ÇÇO P
.
ÇÇP Q

FechaDeFin
ÇÇQ [
)
ÇÇ[ \
)
ÇÇ\ ]
)
ÇÇ] ^
;
ÇÇ^ _
if
ÑÑ 
(
ÑÑ 
	conflicto
ÑÑ 
)
ÑÑ 
{
ÖÖ 
return
ÜÜ 
Ok
ÜÜ 
(
ÜÜ 
$str
ÜÜ X
)
ÜÜX Y
;
ÜÜY Z
}
áá 
reserva
ââ 
.
ââ 
Cliente
ââ 
=
ââ 
cliente
ââ %
;
ââ% &
reserva
ää 
.
ää 

Habitacion
ää 
=
ää  

habitacion
ää! +
;
ää+ ,
return
åå 
null
åå 
;
åå 
}
çç 	
}
éé 
}èè ≥a
|C:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\HabitacionController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class  
HabitacionController %
:& '
ControllerBase( 6
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public  
HabitacionController #
(# $
AppDBContext$ 0
appDbContext1 =
)= >
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitaciones) 8
(8 9
)9 :
{ 	
var 
habitaciones 
= 
await $
_appDbContext% 2
.2 3
Habitaciones3 ?
.? @
ToListAsync@ K
(K L
)L M
;M N
return 
Ok 
( 
habitaciones "
)" #
;# $
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetHabitacion) 6
(6 7
int7 :
id; =
)= >
{ 	
var 

habitacion 
= 
await "
_appDbContext# 0
.0 1
Habitaciones1 =
.= >
	FindAsync> G
(G H
idH J
)J K
;K L
if 
( 

habitacion 
== 
null "
)" #
return$ *
Ok+ -
(- .
$str. G
)G H
;H I
return 
Ok 
( 

habitacion  
)  !
;! "
} 	
[   	
HttpPost  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
CreateHabitacion!!) 9
(!!9 :

Habitacion!!: D

habitacion!!E O
)!!O P
{"" 	
if## 
(## 

habitacion## 
.## 
	Capacidad## $
==##% '
null##( ,
||##- /

habitacion##0 :
.##: ;
	Capacidad##; D
<=##E G
$num##H I
||##J L

habitacion##M W
.##W X
	Capacidad##X a
>=##b d
$num##e f
)##f g
{$$ 
return%% 
Ok%% 
(%% 
$str%% =
)%%= >
;%%> ?
}&& 
if(( 
((( 

habitacion(( 
.(( 
NumeroDeHabitacion(( -
==((. 0
null((1 5
||((6 8

habitacion((9 C
.((C D
NumeroDeHabitacion((D V
<=((W Y
$num((Z [
||((\ ^

habitacion((_ i
.((i j
NumeroDeHabitacion((j |
>((} ~
$num	((~ Å
)
((Å Ç
{)) 
return** 
Ok** 
(** 
$str** T
)**T U
;**U V
}++ 
var-- 
habitacionExistente-- #
=--$ %
await--& +
_appDbContext--, 9
.--9 :
Habitaciones--: F
.--F G
FirstOrDefaultAsync--G Z
(--Z [
h--[ \
=>--] _
h--` a
.--a b
NumeroDeHabitacion--b t
==--u w

habitacion	--x Ç
.
--Ç É 
NumeroDeHabitacion
--É ï
)
--ï ñ
;
--ñ ó
if.. 
(.. 
habitacionExistente.. #
!=..$ &
null..' +
)..+ ,
{// 
return00 
Ok00 
(00 
$str00 I
)00I J
;00J K
}11 
if33 
(33 

habitacion33 
.33 
Costo33  
<=33! #
$num33$ &
||33' )

habitacion33* 4
.334 5
Costo335 :
>33; <
$num33= @
)33@ A
{44 
return55 
Ok55 
(55 
$str55 <
)55< =
;55= >
}66 
if99 
(99 

habitacion99 
.99 
Piso99 
!=99  "
null99# '
&&99( *

habitacion99+ 5
.995 6
Piso996 :
<99; <
$num99= >
||99? A

habitacion99B L
.99L M
Piso99M Q
>99R S
$num99T V
)99V W
{:: 
return;; 
Ok;; 
(;; 
$str;; 9
);;9 :
;;;: ;
}<< 
_appDbContext>> 
.>> 
Habitaciones>> &
.>>& '
Add>>' *
(>>* +

habitacion>>+ 5
)>>5 6
;>>6 7
await?? 
_appDbContext?? 
.??  
SaveChangesAsync??  0
(??0 1
)??1 2
;??2 3
return@@ 
Ok@@ 
(@@ 

habitacion@@  
)@@  !
;@@! "
}BB 	
[DD 	
HttpPutDD	 
(DD 
$strDD 
)DD 
]DD 
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
EditHabitacionEE) 7
(EE7 8
intEE8 ;
idEE< >
,EE> ?

HabitacionEE@ J

habitacionEEK U
)EEU V
{FF 	
ifGG 
(GG 
idGG 
!=GG 

habitacionGG  
.GG  !
IdGG! #
)GG# $
returnGG% +
OkGG, .
(GG. /
$strGG/ S
)GGS T
;GGT U
varII 
habitacionExistenteII #
=II$ %
awaitII& +
_appDbContextII, 9
.II9 :
HabitacionesII: F
.IIF G
	FindAsyncIIG P
(IIP Q
idIIQ S
)IIS T
;IIT U
ifJJ 
(JJ 
habitacionExistenteJJ #
==JJ$ &
nullJJ' +
)JJ+ ,
returnJJ- 3
OkJJ4 6
(JJ6 7
$strJJ7 P
)JJP Q
;JJQ R
ifLL 
(LL 

habitacionLL 
.LL 
	CapacidadLL $
==LL% '
nullLL( ,
||LL- /

habitacionLL0 :
.LL: ;
	CapacidadLL; D
<=LLE G
$numLLH I
||LLJ L

habitacionLLM W
.LLW X
	CapacidadLLX a
>=LLb d
$numLLe f
)LLf g
{MM 
returnNN 
OkNN 
(NN 
$strNN =
)NN= >
;NN> ?
}OO 
ifQQ 
(QQ 

habitacionQQ 
.QQ 
NumeroDeHabitacionQQ -
==QQ. 0
nullQQ1 5
||QQ6 8

habitacionQQ9 C
.QQC D
NumeroDeHabitacionQQD V
<=QQW Y
$numQQZ [
||QQ\ ^

habitacionQQ_ i
.QQi j
NumeroDeHabitacionQQj |
>QQ} ~
$num	QQ Ç
)
QQÇ É
{RR 
returnSS 
OkSS 
(SS 
$strSS T
)SST U
;SSU V
}TT 
varVV 
otraHabitacionVV 
=VV  
awaitVV! &
_appDbContextVV' 4
.VV4 5
HabitacionesVV5 A
.VVA B
FirstOrDefaultAsyncVVB U
(VVU V
hVVV W
=>VVX Z
hVV[ \
.VV\ ]
NumeroDeHabitacionVV] o
==VVp r

habitacionVVs }
.VV} ~
NumeroDeHabitacion	VV~ ê
&&
VVë ì
h
VVî ï
.
VVï ñ
Id
VVñ ò
!=
VVô õ
id
VVú û
)
VVû ü
;
VVü †
ifWW 
(WW 
otraHabitacionWW 
!=WW !
nullWW" &
)WW& '
{XX 
returnYY 
OkYY 
(YY 
$strYY J
)YYJ K
;YYK L
}ZZ 
if\\ 
(\\ 

habitacion\\ 
.\\ 
Costo\\  
<=\\! #
$num\\$ &
||\\' )

habitacion\\* 4
.\\4 5
Costo\\5 :
>\\; <
$num\\= @
)\\@ A
{]] 
return^^ 
Ok^^ 
(^^ 
$str^^ <
)^^< =
;^^= >
}__ 
ifaa 
(aa 

habitacionaa 
.aa 
Pisoaa 
!=aa  "
nullaa# '
&&aa( *

habitacionaa+ 5
.aa5 6
Pisoaa6 :
<aa; <
$numaa= >
||aa? A

habitacionaaB L
.aaL M
PisoaaM Q
>aaR S
$numaaT V
)aaV W
{bb 
returncc 
Okcc 
(cc 
$strcc 9
)cc9 :
;cc: ;
}dd 
habitacionExistentehh 
.hh  
	Capacidadhh  )
=hh* +

habitacionhh, 6
.hh6 7
	Capacidadhh7 @
;hh@ A
habitacionExistenteii 
.ii  
NumeroDeHabitacionii  2
=ii3 4

habitacionii5 ?
.ii? @
NumeroDeHabitacionii@ R
;iiR S
habitacionExistentejj 
.jj  
Costojj  %
=jj& '

habitacionjj( 2
.jj2 3
Costojj3 8
;jj8 9
habitacionExistentekk 
.kk  
Pisokk  $
=kk% &

habitacionkk' 1
.kk1 2
Pisokk2 6
;kk6 7
_appDbContextnn 
.nn 
Habitacionesnn &
.nn& '
Updatenn' -
(nn- .
habitacionExistentenn. A
)nnA B
;nnB C
awaitoo 
_appDbContextoo 
.oo  
SaveChangesAsyncoo  0
(oo0 1
)oo1 2
;oo2 3
returnqq 
Okqq 
(qq 
habitacionExistenteqq )
)qq) *
;qq* +
}rr 	
[tt 	

HttpDeletett	 
(tt 
$strtt 
)tt 
]tt 
publicuu 
asyncuu 
Taskuu 
<uu 
IActionResultuu '
>uu' (
DeleteHabitacionuu) 9
(uu9 :
intuu: =
iduu> @
)uu@ A
{vv 	
varww 

habitacionww 
=ww 
awaitww "
_appDbContextww# 0
.ww0 1
Habitacionesww1 =
.ww= >
	FindAsyncww> G
(wwG H
idwwH J
)wwJ K
;wwK L
ifxx 
(xx 

habitacionxx 
==xx 
nullxx "
)xx" #
returnxx$ *
Okxx+ -
(xx- .
$strxx. G
)xxG H
;xxH I
varzz 
tieneReservacioneszz "
=zz# $
awaitzz% *
_appDbContextzz+ 8
.zz8 9
Reservaszz9 A
.zzA B
AnyAsynczzB J
(zzJ K
rzzK L
=>zzM O
rzzP Q
.zzQ R

HabitacionzzR \
.zz\ ]
Idzz] _
==zz` b
idzzc e
)zze f
;zzf g
if{{ 
({{ 
tieneReservaciones{{ "
){{" #
{|| 
return}} 
Ok}} 
(}} 
$str}} \
)}}\ ]
;}}] ^
}~~ 
_appDbContext
ÄÄ 
.
ÄÄ 
Habitaciones
ÄÄ &
.
ÄÄ& '
Remove
ÄÄ' -
(
ÄÄ- .

habitacion
ÄÄ. 8
)
ÄÄ8 9
;
ÄÄ9 :
await
ÅÅ 
_appDbContext
ÅÅ 
.
ÅÅ  
SaveChangesAsync
ÅÅ  0
(
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3
return
ÉÉ 
Ok
ÉÉ 
(
ÉÉ 
new
ÉÉ 
{
ÉÉ 
message
ÉÉ #
=
ÉÉ$ %
$"
ÉÉ& (
$str
ÉÉ( :
{
ÉÉ: ;
id
ÉÉ; =
}
ÉÉ= >
$str
ÉÉ> V
"
ÉÉV W
}
ÉÉX Y
)
ÉÉY Z
;
ÉÉZ [
}
ÑÑ 	
}
ÖÖ 
}ÜÜ Âz
yC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\Controllers\ClienteController.cs
	namespace 	
prueba
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ClienteController "
:# $
ControllerBase% 3
{		 
private

 
readonly

 
AppDBContext

 %
_appDbContext

& 3
;

3 4
public 
ClienteController  
(  !
AppDBContext! -
appDbContext. :
): ;
{ 	
_appDbContext 
= 
appDbContext (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetClientes) 4
(4 5
)5 6
{ 	
var 
clientes 
= 
await  
_appDbContext! .
.. /
Clientes/ 7
.7 8
ToListAsync8 C
(C D
)D E
;E F
return 
Ok 
( 
clientes 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (

GetCliente) 3
(3 4
int4 7
id8 :
): ;
{ 	
var 
cliente 
= 
await 
_appDbContext  -
.- .
Clientes. 6
.6 7
	FindAsync7 @
(@ A
idA C
)C D
;D E
if 
( 
cliente 
== 
null 
)  
return! '
Ok( *
(* +
$str+ A
)A B
;B C
return 
Ok 
( 
cliente 
) 
; 
} 	
private   
static   
string   
ValidarCliente   ,
(  , -
Cliente  - 4
cliente  5 <
)  < =
{!! 	
if"" 
("" 
string"" 
."" 
IsNullOrWhiteSpace"" )
("") *
cliente""* 1
.""1 2
Nombre""2 8
)""8 9
)""9 :
{## 
return$$ 
$str$$ 1
;$$1 2
}%% 
if&& 
(&& 
!&& 
cliente&& 
.&& 
Nombre&& 
.&&  
All&&  #
(&&# $
char&&$ (
.&&( )
IsLetter&&) 1
)&&1 2
)&&2 3
{'' 
return(( 
$str(( <
;((< =
})) 
if++ 
(++ 
string++ 
.++ 
IsNullOrWhiteSpace++ )
(++) *
cliente++* 1
.++1 2
Apellido++2 :
)++: ;
)++; <
{,, 
return-- 
$str-- 3
;--3 4
}.. 
if// 
(// 
!// 
cliente// 
.// 
Apellido// !
.//! "
All//" %
(//% &
char//& *
.//* +
IsLetter//+ 3
)//3 4
)//4 5
{00 
return11 
$str11 >
;11> ?
}22 
if44 
(44 
string44 
.44 
IsNullOrWhiteSpace44 )
(44) *
cliente44* 1
.441 2
Cedula442 8
)448 9
)449 :
{55 
return66 
$str66 1
;661 2
}77 
if88 
(88 
!88 
cliente88 
.88 
Cedula88 
.88  
All88  #
(88# $
char88$ (
.88( )
IsDigit88) 0
)880 1
)881 2
{99 
return:: 
$str:: =
;::= >
};; 
if<< 
(<< 
!<< 
EsCedulaValida<< 
(<<  
cliente<<  '
.<<' (
Cedula<<( .
)<<. /
)<</ 0
{== 
return>> 
$str>> 9
;>>9 :
}?? 
ifAA 
(AA 
clienteAA 
.AA 
EdadAA 
<AA 
$numAA !
||AA" $
clienteAA% ,
.AA, -
EdadAA- 1
>AA2 3
$numAA4 6
)AA6 7
{BB 
returnCC 
$strCC V
;CCV W
}DD 
returnFF 
$strFF 
;FF 
}GG 	
[II 	
HttpPostII	 
]II 
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
CreateClienteJJ) 6
(JJ6 7
ClienteJJ7 >
clienteJJ? F
)JJF G
{KK 	
varMM 
errorMM 
=MM 
ValidarClienteMM &
(MM& '
clienteMM' .
)MM. /
;MM/ 0
ifNN 
(NN 
errorNN 
!=NN 
$strNN 
)NN 
{OO 
returnPP 
OkPP 
(PP 
errorPP 
)PP  
;PP  !
}QQ 
varSS 
clienteExistenteSS  
=SS! "
awaitSS# (
_appDbContextSS) 6
.SS6 7
ClientesSS7 ?
.SS? @
FirstOrDefaultAsyncSS@ S
(SSS T
cSST U
=>SSV X
cSSY Z
.SSZ [
CedulaSS[ a
==SSb d
clienteSSe l
.SSl m
CedulaSSm s
)SSs t
;SSt u
ifTT 
(TT 
clienteExistenteTT  
!=TT! #
nullTT$ (
)TT( )
{UU 
returnVV 
OkVV 
(VV 
$strVV D
)VVD E
;VVE F
}WW 
_appDbContextYY 
.YY 
ClientesYY "
.YY" #
AddYY# &
(YY& '
clienteYY' .
)YY. /
;YY/ 0
awaitZZ 
_appDbContextZZ 
.ZZ  
SaveChangesAsyncZZ  0
(ZZ0 1
)ZZ1 2
;ZZ2 3
return[[ 
Ok[[ 
([[ 
cliente[[ 
)[[ 
;[[ 
}\\ 	
[__ 	
HttpPut__	 
(__ 
$str__ 
)__ 
]__ 
public`` 
async`` 
Task`` 
<`` 
IActionResult`` '
>``' (
EditCliente``) 4
(``4 5
int``5 8
id``9 ;
,``; <
Cliente``= D
cliente``E L
)``L M
{aa 	
ifbb 
(bb 
idbb 
!=bb 
clientebb 
.bb 
Idbb  
)bb  !
returnbb" (
Okbb) +
(bb+ ,
$strbb, K
)bbK L
;bbL M
vardd 
clienteExistentedd  
=dd! "
awaitdd# (
_appDbContextdd) 6
.dd6 7
Clientesdd7 ?
.dd? @
	FindAsyncdd@ I
(ddI J
idddJ L
)ddL M
;ddM N
ifee 
(ee 
clienteExistenteee  
==ee! #
nullee$ (
)ee( )
returnee* 0
Okee1 3
(ee3 4
$stree4 J
)eeJ K
;eeK L
varhh 
errorhh 
=hh 
ValidarClientehh &
(hh& '
clientehh' .
)hh. /
;hh/ 0
ifii 
(ii 
errorii 
!=ii 
$strii 
)ii 
{jj 
returnkk 
Okkk 
(kk 
errorkk 
)kk  
;kk  !
}ll 
varnn 
clienteConCedulann  
=nn! "
awaitnn# (
_appDbContextnn) 6
.nn6 7
Clientesnn7 ?
.nn? @
FirstOrDefaultAsyncnn@ S
(nnS T
cnnT U
=>nnV X
cnnY Z
.nnZ [
Cedulann[ a
==nnb d
clientenne l
.nnl m
Cedulannm s
&&nnt v
cnnw x
.nnx y
Idnny {
!=nn| ~
id	nn Å
)
nnÅ Ç
;
nnÇ É
ifoo 
(oo 
clienteConCedulaoo  
!=oo! #
nulloo$ (
)oo( )
{pp 
returnqq 
Okqq 
(qq 
$strqq F
)qqF G
;qqG H
}rr 
clienteExistenteuu 
.uu 
Nombreuu #
=uu$ %
clienteuu& -
.uu- .
Nombreuu. 4
;uu4 5
clienteExistentevv 
.vv 
Apellidovv %
=vv& '
clientevv( /
.vv/ 0
Apellidovv0 8
;vv8 9
clienteExistenteww 
.ww 
Edadww !
=ww" #
clienteww$ +
.ww+ ,
Edadww, 0
;ww0 1
clienteExistentexx 
.xx 
Cedulaxx #
=xx$ %
clientexx& -
.xx- .
Cedulaxx. 4
;xx4 5
_appDbContextzz 
.zz 
Clienteszz "
.zz" #
Updatezz# )
(zz) *
clienteExistentezz* :
)zz: ;
;zz; <
await{{ 
_appDbContext{{ 
.{{  
SaveChangesAsync{{  0
({{0 1
){{1 2
;{{2 3
return}} 
Ok}} 
(}} 
clienteExistente}} &
)}}& '
;}}' (
}~~ 	
[
ÅÅ 	

HttpDelete
ÅÅ	 
(
ÅÅ 
$str
ÅÅ 
)
ÅÅ 
]
ÅÅ 
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
IActionResult
ÇÇ '
>
ÇÇ' (
DeleteCliente
ÇÇ) 6
(
ÇÇ6 7
int
ÇÇ7 :
id
ÇÇ; =
)
ÇÇ= >
{
ÉÉ 	
var
ÑÑ 
cliente
ÑÑ 
=
ÑÑ 
await
ÑÑ 
_appDbContext
ÑÑ  -
.
ÑÑ- .
Clientes
ÑÑ. 6
.
ÑÑ6 7
	FindAsync
ÑÑ7 @
(
ÑÑ@ A
id
ÑÑA C
)
ÑÑC D
;
ÑÑD E
if
ÖÖ 
(
ÖÖ 
cliente
ÖÖ 
==
ÖÖ 
null
ÖÖ 
)
ÖÖ  
return
ÖÖ! '
Ok
ÖÖ( *
(
ÖÖ* +
$str
ÖÖ+ A
)
ÖÖA B
;
ÖÖB C
var
áá  
tieneReservaciones
áá "
=
áá# $
await
áá% *
_appDbContext
áá+ 8
.
áá8 9
Reservas
áá9 A
.
ááA B
AnyAsync
ááB J
(
ááJ K
r
ááK L
=>
ááM O
r
ááP Q
.
ááQ R
Cliente
ááR Y
.
ááY Z
Id
ááZ \
==
áá] _
id
áá` b
)
ááb c
;
áác d
if
àà 
(
àà  
tieneReservaciones
àà "
)
àà" #
{
ââ 
return
ää 
Ok
ää 
(
ää 
$str
ää a
)
ääa b
;
ääb c
}
ãã 
_appDbContext
çç 
.
çç 
Clientes
çç "
.
çç" #
Remove
çç# )
(
çç) *
cliente
çç* 1
)
çç1 2
;
çç2 3
await
éé 
_appDbContext
éé 
.
éé  
SaveChangesAsync
éé  0
(
éé0 1
)
éé1 2
;
éé2 3
return
êê 
Ok
êê 
(
êê 
new
êê 
{
êê 
message
êê #
=
êê$ %
$"
êê& (
$str
êê( 7
{
êê7 8
id
êê8 :
}
êê: ;
$str
êê; [
"
êê[ \
}
êê] ^
)
êê^ _
;
êê_ `
}
ëë 	
private
ïï 
static
ïï 
bool
ïï 
EsCedulaValida
ïï *
(
ïï* +
string
ïï+ 1
cedula
ïï2 8
)
ïï8 9
{
ññ 	
if
óó 
(
óó 
cedula
óó 
.
óó 
Length
óó 
!=
óó  
$num
óó! #
||
óó$ &
!
óó' (
cedula
óó( .
.
óó. /
All
óó/ 2
(
óó2 3
char
óó3 7
.
óó7 8
IsDigit
óó8 ?
)
óó? @
)
óó@ A
{
òò 
return
ôô 
false
ôô 
;
ôô 
}
öö 
int
úú 
	provincia
úú 
=
úú 
int
úú 
.
úú  
Parse
úú  %
(
úú% &
cedula
úú& ,
.
úú, -
	Substring
úú- 6
(
úú6 7
$num
úú7 8
,
úú8 9
$num
úú: ;
)
úú; <
)
úú< =
;
úú= >
if
ûû 
(
ûû 
(
ûû 
	provincia
ûû 
<
ûû 
$num
ûû 
||
ûû !
	provincia
ûû" +
>
ûû, -
$num
ûû. 0
)
ûû0 1
&&
ûû2 4
	provincia
ûû5 >
!=
ûû? A
$num
ûûB D
)
ûûD E
{
üü 
return
†† 
false
†† 
;
†† 
}
°° 
int
§§ 
[
§§ 
]
§§ 
coeficientes
§§ 
=
§§  
{
§§! "
$num
§§# $
,
§§$ %
$num
§§& '
,
§§' (
$num
§§) *
,
§§* +
$num
§§, -
,
§§- .
$num
§§/ 0
,
§§0 1
$num
§§2 3
,
§§3 4
$num
§§5 6
,
§§6 7
$num
§§8 9
,
§§9 :
$num
§§; <
}
§§= >
;
§§> ?
int
•• 
suma
•• 
=
•• 
$num
•• 
;
•• 
for
ßß 
(
ßß 
int
ßß 
i
ßß 
=
ßß 
$num
ßß 
;
ßß 
i
ßß 
<
ßß 
coeficientes
ßß  ,
.
ßß, -
Length
ßß- 3
;
ßß3 4
i
ßß5 6
++
ßß6 8
)
ßß8 9
{
®® 
int
©© 
valor
©© 
=
©© 
coeficientes
©© (
[
©©( )
i
©©) *
]
©©* +
*
©©, -
int
©©. 1
.
©©1 2
Parse
©©2 7
(
©©7 8
cedula
©©8 >
[
©©> ?
i
©©? @
]
©©@ A
.
©©A B
ToString
©©B J
(
©©J K
)
©©K L
)
©©L M
;
©©M N
suma
™™ 
+=
™™ 
valor
™™ 
>=
™™  
$num
™™! #
?
™™$ %
valor
™™& +
-
™™, -
$num
™™. /
:
™™0 1
valor
™™2 7
;
™™7 8
}
´´ 
int
≠≠ 
digitoVerificador
≠≠ !
=
≠≠" #
int
≠≠$ '
.
≠≠' (
Parse
≠≠( -
(
≠≠- .
cedula
≠≠. 4
[
≠≠4 5
$num
≠≠5 6
]
≠≠6 7
.
≠≠7 8
ToString
≠≠8 @
(
≠≠@ A
)
≠≠A B
)
≠≠B C
;
≠≠C D
int
ÆÆ 
residuo
ÆÆ 
=
ÆÆ 
suma
ÆÆ 
%
ÆÆ  
$num
ÆÆ! #
;
ÆÆ# $
int
ØØ 
	resultado
ØØ 
=
ØØ 
residuo
ØØ #
==
ØØ$ &
$num
ØØ' (
?
ØØ) *
$num
ØØ+ ,
:
ØØ- .
$num
ØØ/ 1
-
ØØ2 3
residuo
ØØ4 ;
;
ØØ; <
return
±± 
	resultado
±± 
==
±± 
digitoVerificador
±±  1
;
±±1 2
}
≤≤ 	
}
¥¥ 
}µµ ˛,
hC:\Users\matia\OneDrive\Escritorio\Deberes\Pruebas\Gestion de Hotel M_A\GestionProyectos\AppDBContext.cs
	namespace 	
prueba
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{ 
public 
AppDBContext 
( 
DbContextOptions ,
<, -
AppDBContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{T U
}V W
public

 
DbSet

 
<

 
Cliente

 
>

 
Clientes

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
DbSet 
< 

Habitacion 
>  
Habitaciones! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Reserva 
> 
Reservas &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
ServicioAdicional &
>& ' 
ServiciosAdicionales( <
{= >
get? B
;B C
setD G
;G H
}I J
} 
public 

class 
Cliente 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
required 
string 
Nombre %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
required 
string 
Apellido '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
int 
? 
Edad 
{ 
get 
; 
set  #
;# $
}% &
public 
required 
string 
Cedula %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class 

Habitacion 
{ 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
	Capacidad 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
? 
NumeroDeHabitacion &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[   	
JsonRequired  	 
]   
public   
decimal   %
Costo  & +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
int!! 
?!! 
Piso!! 
{!! 
get!! 
;!! 
set!!  #
;!!# $
}!!% &
}"" 
public$$ 

class$$ 
Reserva$$ 
{%% 
public&& 
required&& 
int&& 
Id&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 
required'' 
Cliente'' 
Cliente''  '
{''( )
get''* -
;''- .
set''/ 2
;''2 3
}''4 5
=''6 7
null''8 <
!''< =
;''= >
public(( 
required(( 

Habitacion(( "

Habitacion((# -
{((. /
get((0 3
;((3 4
set((5 8
;((8 9
}((: ;
=((< =
null((> B
!((B C
;((C D
[)) 	
JsonRequired))	 
])) 
public)) 
DateTime)) &
FechaDeReserva))' 5
{))6 7
get))8 ;
;)); <
set))= @
;))@ A
}))B C
[** 	
JsonRequired**	 
]** 
public** 
DateTime** &
FechaDeInicio**' 4
{**5 6
get**7 :
;**: ;
set**< ?
;**? @
}**A B
[++ 	
JsonRequired++	 
]++ 
public++ 
DateTime++ &

FechaDeFin++' 1
{++2 3
get++4 7
;++7 8
set++9 <
;++< =
}++> ?
},, 
public.. 

class.. 
ServicioAdicional.. "
{// 
public00 
required00 
int00 
Id00 
{00  
get00! $
;00$ %
set00& )
;00) *
}00+ ,
public11 
required11 
string11 
Descripcion11 *
{11+ ,
get11- 0
;110 1
set112 5
;115 6
}117 8
=119 :
null11; ?
!11? @
;11@ A
[22 	
JsonRequired22	 
]22 
public22 
decimal22 %
Costo22& +
{22, -
get22. 1
;221 2
set223 6
;226 7
}228 9
public33 
required33 
Reserva33 
Reserva33  '
{33( )
get33* -
;33- .
set33/ 2
;332 3
}334 5
=336 7
null338 <
!33< =
;33= >
}44 
}55 